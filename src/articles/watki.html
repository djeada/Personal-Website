<!DOCTYPE html>
<html lang="pl">

<head>
    <title>Adam Djellouli - Blog</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" />
    <link rel="icon" href="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/icon.ico">
    <link rel="stylesheet" type="text/css" href="../resources/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie-edge" />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5593122079896089" crossorigin="anonymous"></script>
</head>

<body>
    <nav>
        <a class="logo" href="../index.html">
            <img id="logo-image" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/logo.PNG" alt="Adam Djellouli">
        </a>
        <input id="navbar-toggle" type="checkbox" />
        <ul>
            <li> <a href="../index.html"> Home </a> </li>
            <li> <a href="../core/blog.html" class="active"> Blog </a> </li>
            <li> <a href="../core/tools.html"> Tools </a> </li>
            <li> <a href="../core/projects.html"> Projects </a> </li>
            <li> <a href="../core/resume.html"> Resume </a> </li>
            <li> <a href="../core/about.html"> About </a> </li>
            <button id="dark-mode-button"></button>
        </ul>
    </nav>
    <section id="article-body">

        <h3>Wtki</h3>
        <p><i>This article is written in: 叼</i></p>
        <p>Wtki, pozwalaj na r贸wnolege wykonywanie si kilku fragment贸w kodu. Z tego powodu s szczeg贸lnie przydatne do obsugi zada, kt贸re mog zaj du偶o czasu, np. czenie si z zewntrznym serwerem lub wczytywanie du偶ych plik贸w. W ten spos贸b nie musimy czeka na zakoczenie danego zadania, lecz mo偶emy je wykona r贸wnolegle z pozostaymi czynnociami.</p>
        <p>Aby skorzysta z wtk贸w, nale偶y najpierw zaimportowa modu <code>threading</code>. Nastpnie, aby utworzy nowy wtek, nale偶y utworzy obiekt klasy <code>Thread</code>. Klasa ta przyjmuje jako argument funkcj, kt贸ra bdzie wykonana jako wtek.</p>
        <p>
        <div>
            <pre><code class="language-python">import threading
def watek():
    print("Watek")
w1 = threading.Thread(target=watek)</code></pre>
        </div>
        </p>
        <p>Aby uruchomi wtek, nale偶y wywoa metod <code>start</code> na obiekcie klasy <code>Thread</code>.</p>
        <p>
        <div>
            <pre><code class="language-python">w1.start()</code></pre>
        </div>
        </p>
        <p>Nale偶y pamita, 偶e wtki dziaaj r贸wnolegle, wic nie ma gwarancji kolejnoci wykonywania si poszczeg贸lnych wtk贸w. </p>
        <h4>Wasny wtek</h4>
        <p>Aby utworzy wtek, nale偶y stworzy klas dziedziczc po klasie <code>Thread</code> z moduu <code>threading</code> i zdefiniowa metod <code>run</code>, kt贸ra zostanie wywoana przy uruchomieniu wtku. Nastpnie nale偶y utworzy obiekt tej klasy i wywoa metod <code>start</code>, aby rozpocz dziaanie wtku.</p>
        <p>
        <div>
            <pre><code class="language-python">import threading
class MyThread(threading.Thread):
    def run(self):
        # kod, ktory zostanie wykonany w watku
        print("Wtek uruchomiony")
thread = MyThread()
thread.start()</code></pre>
        </div>
        </p>
        <p>Mo偶emy r贸wnie偶 przekaza argumenty do metody <code>run</code> poprzez konstruktor klasy.</p>
        <p>
        <div>
            <pre><code class="language-python">import threading
class MyThread(threading.Thread):
    def init(self, argument):
        self.argument = argument
        super().init()
def run(self):
    # kod, ktory zostanie wykonany w watku
    print(f"Wtek uruchomiony z argumentem: {self.argument}")

thread = MyThread("Hello World")
thread.start()</code></pre>
        </div>
        </p>
        <h4>Zatrzymanie wtku</h4>
        <p>W Pythonie mo偶na zatrzyma wtek poprzez wywoanie metody <code>Thread.join()</code>. Ta metoda blokuje wywoujcy wtek a偶 do momentu, gdy wtek do kt贸rego zostaa wywoana zakoczy swoje dziaanie. Przykadowo, jeli chcemy zatrzyma g贸wny wtek programu do momentu, gdy wszystkie wtki zostan zakoczone, mo偶emy u偶y ptli for i iterowa po licie wtk贸w i dla ka偶dego z nich wywoa metod <code>join()</code>:</p>
        <p>
        <div>
            <pre><code class="language-python">threads = [thread1, thread2, thread3]
for thread in threads:
    thread.join()</code></pre>
        </div>
        </p>
        <p>Mo偶na r贸wnie偶 u偶y metody <code>Thread.join(timeout)</code> z opcjonalnym parametrem <code>timeout</code>. Parametr ten okrela maksymalny czas oczekiwania na zakoczenie wtku. Jeli wtek nie zakoczy dziaania w cigu tego czasu, wtek wywoujcy metod <code>join()</code> zostanie wznowiony.</p>
        <p>Innym sposobem zatrzymania wtku jest u偶ycie zmiennej globalnej <code>threading.Event</code> z metodami <code>wait()</code> i <code>set()</code>. Wtek, kt贸ry chcemy zatrzyma, mo偶e oczekiwa na sygna za pomoc metody <code>wait()</code>, a wtek g贸wny mo偶e wysa sygna za pomoc metody <code>set()</code>. W przypadku u偶ycia tej metody, wtek oczekujcy mo偶e r贸wnie偶 ustawi opcjonalny limit czasu oczekiwania.</p>
        <p>
        <div>
            <pre><code class="language-python">import threading
# utworzenie zmiennej Event
stop_event = threading.Event()
def worker_thread():
    while not stop_event.is_set():
        # wtek wykonuje swoje zadania
        do_some_work()
    # po otrzymaniu sygnalu zatrzymujemy watek
    stop_event.clear()
# ...
# glowny watek chce zatrzymac worker_thread
stop_event.set()</code></pre>
        </div>
        </p>
        <p>Nale偶y pamita, 偶e zatrzymanie wtku nie jest powszechnie zalecan metod zarzdzania wtkami. W wielu przypadkach lepszym rozwizaniem jest u偶ycie warunk贸w synchronizacyjnych lub zamknicia wtku za pomoc metody <code>join()</code>. Zatrzymanie wtku mo偶e powodowa nieoczekiwane skutki uboczne i powinno by u偶ywane jedynie w wyjtkowych sytuacjach.</p>
        <h4>Dzielenie zasob贸w midzy wtkami</h4>
        <p>Dzielenie zasob贸w midzy wtkami polega na umo偶liwieniu kilku wtkom r贸wnoczesnego dostpu do wsp贸lnego zasobu. W przypadku, gdy zas贸b jest zmienny, konieczne jest zapewnienie bezpieczestwa jego dostpu, tzn. zapobiegnicie sytuacji, w kt贸rej kilka wtk贸w bdzie pr贸bowao zmodyfikowa ten sam zas贸b w tym samym czasie. Istniej mechanizmy umo偶liwiajce bezpieczne dzielenie zasob贸w midzy wtkami, takie jak obiekt <code>Lock</code>.</p>
        <p>Przykad:</p>
        <p>
        <div>
            <pre><code class="language-python">import threading
# Zmienna globalna, do kt贸rej bd miay dostp wtki
zmienna_globalna = 0
# Obiekt Lock, kt贸ry bdziemy u偶ywali do synchronizacji dostpu do zmiennej globalnej
lock = threading.Lock()
def watek1():
    global zmienna_globalna
    for i in range(100):
    # Pobieramy lock, aby mie pewno, 偶e tylko jeden wtek bdzie
    # mia dostp do zmiennej globalnej w danym momencie
    lock.acquire()
    zmienna_globalna += 1
    lock.release()
def watek2():
    global zmienna_globalna
    for i in range(100):
    # Pobieramy lock, aby mie pewno, 偶e tylko jeden wtek bdzie
    # mia dostp do zmiennej globalnej w danym momencie
    lock.acquire()
    zmienna_globalna -= 1
    lock.release()
# Uruchamiamy wtki
t1 = threading.Thread(target=watek1)
t2 = threading.Thread(target=watek2)
t1.start()
t2.start()
# Czekamy na zakoczenie obu wtk贸w
t1.join()
t2.join()
# Wypisujemy warto zmiennej globalnej
print(zmienna_globalna)</code></pre>
        </div>
        </p>
        <p>W tym przykadzie mamy dwie funkcje <code>watek1</code> i <code>watek2</code>, kt贸re zmieniaj warto zmiennej globalnej <code>zmienna_globalna</code>. Aby zapewni bezpieczne dzielenie zasob贸w midzy wtkami, u偶yto mechanizmu blokady. </p>
        <h4>GIL</h4>
        <p>GIL, czyli Global Interpreter Lock, to mechanizm, kt贸ry ogranicza mo偶liwo jednoczesnego wykonywania kodu przez wiele wtk贸w. W Pythonie ka偶dy wtek jest obsugiwany przez GIL, kt贸ry kontroluje dostp do interpretera. W rezultacie tylko jeden wtek jest w stanie wykonywa kod naraz, a pozostae s zawieszane a偶 do momentu, gdy GIL zostanie zwolniony.</p>
        <p>GIL jest wbudowanym mechanizmem w Pythonie, kt贸ry zosta dodany w celu uniknicia problem贸w zwizanych z wsp贸dzieleniem zasob贸w przez wiele wtk贸w. Chocia偶 GIL mo偶e mie pewne ograniczenia w przypadku bardzo obci偶ajcych proces贸w wielowtkowych, w wikszoci przypadk贸w jest on wystarczajcy do obsugi r贸wnolegoci w Pythonie.</p>
        <p>Przykadowo, jeli chcielibymy utworzy program, kt贸ry bdzie sumowa elementy w licie, mo偶emy to zrobi za pomoc wielu wtk贸w. Ka偶dy wtek bdzie odpowiedzialny za sumowanie czci listy. Niestety, GIL spowoduje, 偶e tylko jeden wtek bdzie wykonywany w danym momencie, co spowolni dziaanie programu.</p>
        <p>Oto przykad programu sumujcego elementy w licie z u偶yciem wtk贸w:</p>
        <p>
        <div>
            <pre><code class="language-python">import threading
def sum_list(numbers):
    # Funkcja sumujca elementy w licie
    total = 0
    for number in numbers:
        total += number
    print(total)
# Utworzenie wtk贸w
thread1 = threading.Thread(target=sum_list, args=([1, 2, 3],))
thread2 = threading.Thread(target=sum_list, args=([4, 5, 6],))
thread3 = threading.Thread(target=sum_list, args=([7, 8, 9],))
# Uruchomienie wtk贸w
thread1.start()
thread2.start()
thread3.start()
# Oczekiwanie na zakoczenie wtk贸w
thread1.join()
thread2.join()
thread3.join()</code></pre>
        </div>
        </p>
        <p>W powy偶szym przykadzie, chocia偶 mamy trzy wtki, GIL spowoduje, 偶e tylko jeden z nich bdzie wykonywany w danym momencie, co sprawi 偶e u偶ycie wtk贸w nie pomo偶e z przyspieszeniem dziaania progrmau.</p>

    </section>
    <footer>
        <div class="footer-columns">
            <div class="footer-column">
                <img src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/symbol.png" alt="Adam Djellouli">

            </div>
            <div class="footer-column">

                <p>
                    Thank you for visiting my personal website. All of the </br>
                    content on this site is free to use, but please remember </br>
                    to be a good human being and refrain from any abuse</br>
                    of the site. If you would like to contact me, please use </br>
                    my LinkedIn profile or my GitHub if you have any technical </br>
                    issues or ideas to share. I wish you the best and hope you </br>
                    have a fantastic life. </br>
                </p>

            </div>
            <div class="footer-column">
                <h2>Follow me</h2>
                <ul class="social-media">
                    <li>
                        <a href="https://www.youtube.com/channel/UCGPoHTVjMN77wcGknXPHl1Q" class="fa fa-youtube" target="_blank">

                        </a>YouTube
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" class="fa fa-linkedin" target="_blank">

                        </a>LinkedIn
                    </li>
                    <li>
                        <a href="https://www.instagram.com/addjellouli/" class="fa fa-instagram" target="_blank">
                        </a>Instagram

                    </li>
                    <li>
                        <a href="https://github.com/djeada" class="fa fa-github">
                        </a>Github

                    </li>

                </ul>
            </div>
        </div>
        <div>
            <p id="copyright">
                &copy; Adam Djellouli. All rights reserved.
            </p>
        </div>
        <script>
            document.getElementById("copyright").innerHTML = "&copy; " + new Date().getFullYear() + " Adam Djellouli. All rights reserved.";
        </script>
        <script src="../app.js"></script>
    </footer>
</body>

</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-python.min.js"></script>