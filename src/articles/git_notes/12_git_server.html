<!DOCTYPE html>

<html lang="en">

<head>
    <script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5593122079896089"></script>
    <meta charset="utf-8" />
    <title>Git Server</title>
    <meta content="Running your own Git server is about owning your source of truth." name="description" />
    <meta content="Adam Djellouli" name="author" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <link crossorigin="" href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/icon.ico" rel="icon" />
    <link href="../../resources/style.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>
    <nav aria-label="Main navigation">
        <a class="logo" href="https://adamdjellouli.com">
            <img alt="Adam Djellouli - Home Page Logo" id="logo-image" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/logo.PNG" />
        </a>
        <input aria-label="Toggle navigation menu" id="navbar-toggle" type="checkbox" />
        <ul aria-labelledby="navbar-toggle" role="menu">
            <li role="menuitem">
                <a href="../../index.html" title="Go to Home Page"> Home </a>
            </li>
            <li role="menuitem">
                <a class="active" href="../../core/blog.html" title="Read Adam Djellouli Blog on Programming and Technology"> Blog </a>
            </li>
            <li role="menuitem">
                <a href="../../core/tools.html" title="Discover Tools Created by Adam Djellouli"> Tools </a>
            </li>
            <li role="menuitem">
                <a href="../../core/projects.html" title="Explore Projects Developed by Adam Djellouli"> Projects </a>
            </li>
            <li role="menuitem">
                <a href="../../core/resume.html" title="View Adam Djellouli Professional Resume"> Resume </a>
            </li>
            <li>
                <script async="" src="https://cse.google.com/cse.js?cx=8160ef9bb935f4f68"></script>
                <div class="gcse-search"></div>
            </li>
            <li>
                <button aria-label="Toggle dark mode" id="dark-mode-button"></button>
            </li>
        </ul>
    </nav>
    <div id="article-wrapper"><article-section id="article-body">
            <div class="article-action-buttons"><button class="btn-suggest-edit" title="Suggest Edit">
                    <svg fill="none" height="20" viewbox="0 0 24 24" width="20">
                        <path d="M4 21h4l11-11-4-4L4 17v4z" stroke="currentColor" stroke-width="2"></path>
                    </svg>
                </button><button class="btn-create-issue" title="Create Issue">
                    <svg fill="none" height="20" viewbox="0 0 24 24" width="20">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"></circle>
                        <line stroke="currentColor" stroke-width="2" x1="12" x2="12" y1="8" y2="12"></line>
                        <circle cx="12" cy="16" fill="currentColor" r="1"></circle>
                    </svg>
                </button><button class="btn-download" title="Download">
                    <svg fill="none" height="20" viewbox="0 0 24 24" width="20">
                        <path d="M12 5v14m0 0l-6-6m6 6l6-6" stroke="currentColor" stroke-width="2"></path>
                    </svg>
                </button></div>
            <p style="text-align: right;"><i>Last modified: September 13, 2025</i></p>
            <p style="text-align: right;"><i>This article is written in: üá∫üá∏</i></p>
            <h2 id="git-server">Git Server</h2>
            <p>Running your own Git server is about owning your source of truth. Your repos live where you decide, under rules you set, at a pace you control. That means you decide who can read and write, how code moves to production, and how the system grows as your team and projects grow. It‚Äôs pure Git under the hood‚Äîno mystery platform layers‚Äîso you get predictability, auditability, and hooks you can bend into real-world workflows like auto-deploys, mirroring, and backups. If you‚Äôve ever wanted a quiet, dependable place for code that you can lock down, wire up, and scale out, a bare Git server is exactly that.</p>
            <p>
            <div>
                <pre><code class="language-shell">+-------------------+              +-------------------+
|   Git Client 1    |              |   Git Client 2    |
| - Clone           |              | - Push            |
| - Pull            |              | - Pull Requests   |
| - Push            |              | - Merge           |
+--------+----------+              +----------+--------+
         |                                   |
         |                                   |
         +----+----------------------+-------+
              |                      |
              |    Git Operations    |
              |                      |
         +----v----------------------v----+
         |                                |
         |       Git Server (Bare)        |
         | - Central Repository Storage   |
         | - Access Control               |
         | - Version History Management   |
         | - Branches &amp; Tags Handling     |
         |                                |
         +--------------------------------+</code></pre>
            </div>
            </p>
            <h3 id="prerequisites">Prerequisites</h3>
            <p>Pick a Debian/Ubuntu box you trust. You‚Äôll connect over SSH because it‚Äôs simple, secure, and scriptable. You‚Äôll need admin rights once to set things up; after that, day-to-day work happens with regular user access. Think of the server as a quiet filesafe that only speaks Git over SSH‚Äîno fancy web UI required unless you want one later.</p>
            <h4 id="commands">Commands</h4>
            <p>Update packages and install Git:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo apt update
sudo apt install git</code></pre>
            </div>
            </p>
            <p>Show the installed version:</p>
            <p>
            <div>
                <pre><code class="language-bash">git --version
# output (example):
# git version 2.43.0</code></pre>
            </div>
            </p>
            <h3 id="create-a-place-for-repos">Create a place for repos</h3>
            <p>A bare repository is the central hub with no working directory‚Äîno editable files, just Git‚Äôs object store and refs. It‚Äôs perfect as a shared remote: everyone clones from it, pushes to it, and pulls from it. Since it‚Äôs not a checkout, nothing on the server gets ‚Äúdirty,‚Äù and hooks can react to pushes cleanly.</p>
            <p>Create a home for repos and initialize one:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo mkdir -p /opt/git/myrepo.git
sudo git init --bare /opt/git/myrepo.git
sudo tree -L 1 /opt/git/myrepo.git 2&gt;/dev/null || ls -1 /opt/git/myrepo.git
# output (typical top-level contents):
# HEAD
# config
# description
# hooks
# info
# objects
# refs</code></pre>
            </div>
            </p>
            <p>Set ownership so the dedicated Git user (we‚Äôll make it next) can write:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo chown -R git:git /opt/git</code></pre>
            </div>
            </p>
            <p>A quick mental map of a bare repo:</p>
            <p>
            <div>
                <pre><code class="language-shell">/opt/git/myrepo.git
‚îú‚îÄ config        (repo settings)
‚îú‚îÄ objects/      (all commits, trees, blobs)
‚îú‚îÄ refs/         (branches, tags)
‚îú‚îÄ hooks/        (scripts on push/receive)
‚îî‚îÄ HEAD          (default branch pointer)</code></pre>
            </div>
            </p>
            <h3 id="create-a-dedicated-git-user-and-lock-it-down">Create a dedicated ‚Äúgit‚Äù user and lock it down</h3>
            <p>A separate user keeps permissions simple and tidy. You‚Äôll log in as <code>git</code> using SSH keys, not passwords. You can go further and restrict the shell so this user can only run Git‚Äîhandy on shared servers.</p>
            <p>Create the user:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo adduser --disabled-password --gecos "" git
# set a password only if you really need one; keys are better
# to fully lock password logins:
sudo passwd -l git</code></pre>
            </div>
            </p>
            <p>Set up SSH keys for the git user:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo -u git mkdir -p ~git/.ssh
sudo -u git chmod 700 ~git/.ssh
sudo -u git touch ~git/.ssh/authorized_keys
sudo -u git chmod 600 ~git/.ssh/authorized_keys</code></pre>
            </div>
            </p>
            <p>Authorize a developer (paste their public key):</p>
            <p>
            <div>
                <pre><code class="language-bash"># Example key, replace with a real developer's public key:
echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFAKEKEYEXAMPLEONLY1234567890abcdefg dev@laptop" | sudo tee -a ~git/.ssh/authorized_keys
# output:
# ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFAKEKEYEXAMPLEONLY1234567890abcdefg dev@laptop</code></pre>
            </div>
            </p>
            <p>Optional: restrict the git user to git-only commands:</p>
            <p>
            <div>
                <pre><code class="language-bash">which git-shell
# output (example):
# /usr/bin/git-shell
sudo chsh -s /usr/bin/git-shell git</code></pre>
            </div>
            </p>
            <p>ASCII view of the handshake:</p>
            <p>
            <div>
                <pre><code class="language-shell">[Developer Laptop] --(SSH key)--&gt; [Server: user=git] --(authorized_keys)--&gt; [myrepo.git]</code></pre>
            </div>
            </p>
            <h3 id="use-the-repo-from-a-developer-machine">Use the repo from a developer machine</h3>
            <p>Developers treat the server like any other remote. Clone once, make changes locally, push/pull when needed. The remote URL points at the bare repo path.</p>
            <p>Clone:</p>
            <p>
            <div>
                <pre><code class="language-bash">git clone git@yourserver:/opt/git/myrepo.git
# or: git clone ssh://git@yourserver/opt/git/myrepo.git
# output:
# Cloning into 'myrepo'...
# warning: You appear to have cloned an empty repository.</code></pre>
            </div>
            </p>
            <p>Make a first commit and push:</p>
            <p>
            <div>
                <pre><code class="language-bash">cd myrepo
echo "hello" &gt; README.md
git add README.md
git commit -m "Initial commit"
# output (commit):
# [main (root-commit) 1a2b3c4] Initial commit
#  1 file changed, 1 insertion(+)
#  create mode 100644 README.md

git push origin main
# output:
# Enumerating objects: 3, done.
# Counting objects: 100% (3/3), done.
# Writing objects: 100% (3/3), 233 bytes | 233.00 KiB/s, done.
# Total 3 (delta 0), reused 0 (delta 0)
# To yourserver:/opt/git/myrepo.git
#  * [new branch]      main -&gt; main</code></pre>
            </div>
            </p>
            <p>Pull later:</p>
            <p>
            <div>
                <pre><code class="language-bash">git pull origin main
# output:
# Already up to date.</code></pre>
            </div>
            </p>
            <p>A tiny commit graph, just to visualize branches:</p>
            <p>
            <div>
                <pre><code class="language-shell">A---B---C  main
 \       
  D---E   feature/login</code></pre>
            </div>
            </p>
            <h3 id="practical-use-case-1-small-team-sharing-a-central-remote">Practical use case 1: small team sharing a central remote</h3>
            <p>You‚Äôve got two or more devs, each with their own laptops. Everyone clones the central bare repo, works on branches, and pushes to <code>origin</code>. Merges and reviews can happen locally or via lightweight conventions (e.g., ‚Äúfeature branches reviewed by pair buddy before merging‚Äù). No web app is required; it‚Äôs Git basics, fast and quiet.</p>
            <p>Add a teammate‚Äôs remote (from their side it‚Äôs the same clone step). Typical day-to-day:</p>
            <p>
            <div>
                <pre><code class="language-bash"># create a feature branch
git switch -c feature/api

# work, commit
git add .
git commit -m "Add API endpoint"

# push branch to share
git push -u origin feature/api
# output:
# To yourserver:/opt/git/myrepo.git
#  * [new branch]      feature/api -&gt; feature/api

# open a review however your team likes (chat, issue tracker, etc.)
# merge locally when approved
git switch main
git pull --ff-only
git merge --no-ff feature/api -m "Merge feature/api"
git push</code></pre>
            </div>
            </p>
            <h3 id="practical-use-case-2-auto-deploy-on-push-post-receive-hook-">Practical use case 2: auto-deploy on push (post-receive hook)</h3>
            <p>When code lands on a specific branch, you can kick off a deployment script. With a bare repo, the server always sees pushes, so hooks are the perfect trigger.</p>
            <p>Create a <code>post-receive</code> hook:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo -u git tee /opt/git/myrepo.git/hooks/post-receive &gt;/dev/null &lt;&lt;'SH'
#!/usr/bin/env bash
set -euo pipefail

read oldrev newrev refname
branch=${refname#refs/heads/}

if [ "$branch" = "main" ]; then
  workdir=/var/www/myapp
  if [ ! -d "$workdir/.git" ]; then
    git --work-tree="$workdir" --git-dir=/opt/git/myrepo.git checkout -f main
  else
    git --work-tree="$workdir" --git-dir=/opt/git/myrepo.git fetch origin main
    git --work-tree="$workdir" --git-dir=/opt/git/myrepo.git checkout -f main
  fi
  # place build/restart steps here:
  # systemctl restart myapp.service
  echo "Deployed $(git --git-dir=/opt/git/myrepo.git rev-parse --short main) to $workdir"
fi
SH
sudo chmod +x /opt/git/myrepo.git/hooks/post-receive</code></pre>
            </div>
            </p>
            <p>Push to trigger:</p>
            <p>
            <div>
                <pre><code class="language-bash">git push origin main
# output (server hook echoes back):
# Deployed 9f3a1c2 to /var/www/myapp</code></pre>
            </div>
            </p>
            <p>Small mental picture of the flow:</p>
            <p>
            <div>
                <pre><code class="language-shell">dev -&gt; push main ---&gt; [bare repo hook] ---&gt; sync files to /var/www/myapp ---&gt; restart service</code></pre>
            </div>
            </p>
            <h3 id="practical-use-case-3-mirror-to-github-gitlab-while-keeping-on-prem-as-source-of-truth">Practical use case 3: mirror to GitHub/GitLab while keeping on-prem as source of truth</h3>
            <p>Keep private control but still use hosted services for CI or collaboration. The server can push to an external remote after each update.</p>
            <p>Add a mirror remote on any clone (or via a server-side hook):</p>
            <p>
            <div>
                <pre><code class="language-bash">git remote add mirror git@github.com:org/myrepo.git
git push --mirror mirror
# output:
# * [new branch] main -&gt; main
# * [new tag] v1.0 -&gt; v1.0</code></pre>
            </div>
            </p>
            <p>Optional server-side hook snippet (append to <code>post-receive</code>):</p>
            <p>
            <div>
                <pre><code class="language-bash"># inside the if [ "$branch" = "main" ]; then block
git --git-dir=/opt/git/myrepo.git push --mirror mirror || echo "Mirror push failed"</code></pre>
            </div>
            </p>
            <h3 id="security-and-hygiene-that-actually-helps">Security and hygiene that actually helps</h3>
            <p>Keep SSH key-only access. Keep the <code>git</code> user owning <code>/opt/git</code> and nothing else. Back up the bare repos like regular files; they‚Äôre self-contained. If you expose SSH to the internet, firewall it, fail2ban it, or tuck it behind a VPN. Updates for the OS and Git are boring and necessary; set a rhythm and stick to it.</p>
            <p>Basic firewall (UFW) with SSH allowed:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo apt install ufw
sudo ufw allow OpenSSH
sudo ufw enable
sudo ufw status
# output (example):
# Status: active
# To                         Action      From
# --                         ------      ----
# OpenSSH                    ALLOW       Anywhere
# OpenSSH (v6)               ALLOW       Anywhere (v6)</code></pre>
            </div>
            </p>
            <p>Back up your repos (rsync and tar both work great):</p>
            <p>
            <div>
                <pre><code class="language-bash"># rsync to another disk or host
sudo rsync -a --delete /opt/git/ /backup/git/

# tar snapshot (quick &amp; simple)
sudo tar -C /opt -czf /backup/myrepos-$(date +%F).tar.gz git</code></pre>
            </div>
            </p>
            <p>Update the box:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo apt update &amp;&amp; sudo apt upgrade -y</code></pre>
            </div>
            </p>
            <h3 id="troubleshooting">Troubleshooting</h3>
            <p>Most hiccups are permission or key issues. If pushes fail with ‚Äúpermission denied (publickey)‚Äù, the server didn‚Äôt accept your key. If pushes fail with ‚Äúnon-fast-forward‚Äù, your branch is behind‚Äîpull or rebase, then push. If you accidentally <code>git init</code> inside the bare repo directory from a client, you‚Äôre in the wrong place‚Äîwork in your clone, not on the server.</p>
            <p>Check SSH key is being used:</p>
            <p>
            <div>
                <pre><code class="language-bash">ssh -v git@yourserver 'echo ok'
# output (look for):
# Offering public key: /home/dev/.ssh/id_ed25519
# Authenticated to yourserver (...)
# ok</code></pre>
            </div>
            </p>
            <p>Fix repo permissions:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo chown -R git:git /opt/git
sudo find /opt/git -type d -exec chmod 755 {} \;
sudo find /opt/git -type f -exec chmod 644 {} \;
sudo chmod -R 700 ~git/.ssh
sudo chmod 600 ~git/.ssh/authorized_keys</code></pre>
            </div>
            </p>
            <p>Resolve non-fast-forward:</p>
            <p>
            <div>
                <pre><code class="language-bash">git pull --rebase origin main
git push origin main
# output:
# Successfully rebased and updated refs/heads/main.</code></pre>
            </div>
            </p>
            <p>Verify the remote URL:</p>
            <p>
            <div>
                <pre><code class="language-bash">git remote -v
# output:
# origin  git@yourserver:/opt/git/myrepo.git (fetch)
# origin  git@yourserver:/opt/git/myrepo.git (push)</code></pre>
            </div>
            </p>
            <h3 id="optional-lightweight-web-ui">Optional lightweight web UI</h3>
            <p>Sometimes you just want a simple window into your repos without adopting a whole platform. That‚Äôs what cgit and gitweb give you: a fast, read-only catalog of your bare repos with clickable history, diffs, blame, and tarball downloads. They don‚Äôt change your Git workflow at all; pushes still happen over SSH, and the web UI only reads from the same <code>/opt/git/*.git</code> directories. You can put it behind HTTPS and basic auth for internal eyes, expose it read-only to CI and stakeholders, or leave it on a private network. Think of it as a static-feeling dashboard backed by your live repos‚Äîzero database, tiny surface area, and easy to back up or blow away.</p>
            <p>
            <div>
                <pre><code class="language-shell">Browser
   |
   v
[ Nginx/Apache ] --(CGI/FastCGI)--&gt; [ cgit/gitweb ] --(read-only)--&gt; /opt/git/*.git
                                                         |
                                                         +-- renders commits, diffs, trees</code></pre>
            </div>
            </p>
            <p>cgit quick path on Debian/Ubuntu. You install cgit and a tiny CGI wrapper, point it at your repo directory, and let your web server hand off requests. The result is a snappy index page with per-repo views and RSS/Atom feeds you can wire into chat or dashboards.</p>
            <p>
            <div>
                <pre><code class="language-bash"># Install cgit (UI), fcgiwrap (runs CGI), and a web server (pick one)
sudo apt update
sudo apt install -y cgit fcgiwrap nginx apache2-utils

# Make sure your repos are where you expect
sudo ls /opt/git | head
# output (example):
# myrepo.git
# infra.git
# website.git</code></pre>
            </div>
            </p>
            <p>Tell cgit where to look and how to present things. The config is plain text; the important bit is <code>scan-path</code>, which walks a directory and treats <code>*.git</code> as repos. You can group by path segments, enable blame/diff links, and set a friendly title.</p>
            <p>
            <div>
                <pre><code class="language-bash"># /etc/cgitrc
sudo tee /etc/cgitrc &gt;/dev/null &lt;&lt;'CFG'
# where to find bare repos
scan-path=/opt/git

# top-level branding
root-title=Company Git
root-desc=Fast, read-only views of our repositories

# organize list by folder names (e.g., libs/foo.git -&gt; section "libs")
section-from-path=1

# useful features
enable-git-config=1
enable-index-owner=1
enable-index-links=1
enable-log-filecount=1
enable-log-linecount=1
enable-commit-graph=1
enable-blame=1
enable-diff=1

# cache to speed up large repos (tune for your box)
cache-size=512
CFG</code></pre>
            </div>
            </p>
            <p>Wire cgit into Nginx. The <code>fcgiwrap</code> service runs the CGI binary; Nginx forwards requests to it. You can mount it at <code>/cgit/</code> to keep things tidy. While you‚Äôre here, you can also enable smart HTTP cloning so read-only clones work over HTTPS in addition to SSH.</p>
            <p>
            <div>
                <pre><code class="language-bash"># Nginx site: /etc/nginx/sites-available/cgit
sudo tee /etc/nginx/sites-available/cgit &gt;/dev/null &lt;&lt;'NGX'
server {
    listen 80;
    server_name _;

    # cgit UI at /cgit/
    location /cgit/ {
        root /usr/lib;
        fastcgi_param SCRIPT_FILENAME /usr/lib/cgit/cgit.cgi;
        fastcgi_param PATH_INFO $uri;
        include fastcgi_params;
        fastcgi_pass unix:/run/fcgiwrap.socket;
    }

    # static assets shipped with cgit (CSS, logo)
    location /cgit.css {
        root /usr/share/cgit;
    }
    location /cgit.png {
        root /usr/share/cgit;
    }

    # optional: smart HTTP for read-only clones via /git/
    # e.g., git clone http://server/git/myrepo.git
    location /git/ {
        root /opt;
        gzip off;
        include fastcgi_params;
        fastcgi_param GIT_HTTP_EXPORT_ALL "";
        fastcgi_param GIT_PROJECT_ROOT /opt/git;
        fastcgi_param PATH_INFO $uri;
        fastcgi_pass unix:/run/fcgiwrap.socket;
        # Make sure repos have git-daemon-export-ok or rely on GIT_HTTP_EXPORT_ALL above
    }
}
NGX

# Enable site and start services
sudo ln -s /etc/nginx/sites-available/cgit /etc/nginx/sites-enabled/cgit
sudo systemctl enable --now fcgiwrap
sudo systemctl reload nginx

# Quick smoke test
curl -I http://localhost/cgit/
# output:
# HTTP/1.1 200 OK
# Content-Type: text/html</code></pre>
            </div>
            </p>
            <p>Lock it down or open it up, your call. For internal-only, keep it on a private network or put simple basic auth in front; for public read-only, just serve it over HTTPS. Basic auth is enough for ‚Äúonly the team can see this,‚Äù while write access still flows over SSH keys to the bare repos.</p>
            <p>
            <div>
                <pre><code class="language-bash"># Create an htpasswd file for Nginx basic auth
sudo htpasswd -c /etc/nginx/.cgit.htpasswd alice
# (enter a password)
# Then add to the /cgit/ location block:
#   auth_basic "Restricted";
#   auth_basic_user_file /etc/nginx/.cgit.htpasswd;
sudo nginx -t &amp;&amp; sudo systemctl reload nginx</code></pre>
            </div>
            </p>
            <p>GitWeb alternative if you prefer the classic look. Same idea‚Äîscan a directory of bare repos and render HTML‚Äîbut with a slightly different aesthetic and defaults. It plays well with Apache out of the box and is perfectly fine for small to mid-sized setups.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo apt install -y gitweb apache2
# Point GitWeb at /opt/git
sudo sed -i 's|^\$projectroot =.*|$projectroot = "/opt/git";|' /etc/gitweb.conf

# Enable Apache config that ships with GitWeb
sudo a2enconf gitweb
sudo systemctl reload apache2

curl -I http://localhost/gitweb/
# output:
# HTTP/1.1 200 OK
# Content-Type: text/html; charset=UTF-8</code></pre>
            </div>
            </p>
            <p>A couple of sanity checks and gotchas that save time. Make sure the web server user can read the repos but not write to them; world-readable is fine for public read-only, or keep it group-readable and add the web user to the <code>git</code> group for internal sites. If the page is blank, it‚Äôs usually a CGI miswire‚Äîverify <code>fcgiwrap</code> is running and the <code>SCRIPT_FILENAME</code> path points to <code>cgit.cgi</code>. If cloning over HTTP 404s, check the <code>/git/</code> location, <code>GIT_PROJECT_ROOT</code>, and that your repo is actually under <code>/opt/git</code> and ends with <code>.git</code>.</p>
            <p>
            <div>
                <pre><code class="language-bash"># Permissions for internal read-only (web server is in group 'git')
sudo chgrp -R git /opt/git
sudo find /opt/git -type d -exec chmod 755 {} \;
sudo find /opt/git -type f -exec chmod 644 {} \;
sudo usermod -aG git www-data</code></pre>
            </div>
            </p>
            <p>Once it‚Äôs up, it becomes a pleasant habit: paste a link to a commit in chat, skim a blame line during code review, let PMs browse the changelog without needing Git installed, and hook the feed URL into your release channel. It‚Äôs the low-maintenance way to make your on-prem Git feel visible without turning it into a whole new platform.</p>
            <h3 id="quick-reference-do-these-in-order-">Quick reference (do these in order)</h3>
            <p>I. Install Git, make a bare repo, ensure <code>git:git</code> owns it.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo apt install git
sudo mkdir -p /opt/git/myrepo.git
sudo git init --bare /opt/git/myrepo.git
sudo chown -R git:git /opt/git</code></pre>
            </div>
            </p>
            <p>II. Create the <code>git</code> user and load developer keys.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo adduser --disabled-password --gecos "" git
sudo -u git mkdir -p ~git/.ssh &amp;&amp; sudo -u git chmod 700 ~git/.ssh
sudo -u git touch ~git/.ssh/authorized_keys &amp;&amp; sudo -u git chmod 600 ~git/.ssh/authorized_keys
echo "ssh-ed25519 &lt;ssh-public-key&gt; dev@laptop" | sudo tee -a ~git/.ssh/authorized_keys</code></pre>
            </div>
            </p>
            <p>III. Clone and push from a dev machine.</p>
            <p>
            <div>
                <pre><code class="language-bash">git clone git@yourserver:/opt/git/myrepo.git
cd myrepo
echo "ok" &gt; README.md &amp;&amp; git add README.md &amp;&amp; git commit -m "init" &amp;&amp; git push -u origin main</code></pre>
            </div>
            </p>
            <p>A final mental model to carry around:</p>
            <p>
            <div>
                <pre><code class="language-shell">[devs &amp; CI] &lt;--&gt; ssh://git@server/opt/git/*.git  (bare repos)
                    |
                    +--&gt; hooks (deploy, mirror, notify)
                    |
                    +--&gt; backups (rsync/tar)</code></pre>
            </div>
            </p>
            <p>That‚Äôs it. You‚Äôve got a clean, self-hosted Git setup that‚Äôs easy to reason about, easy to secure, and easy to extend when you need more.</p>
        </article-section>
        <div id="table-of-contents">
            <h2>Table of Contents</h2>
            <ol><a href="#git-server">Git Server</a>
                <ol>
                    <li><a href="#prerequisites">Prerequisites</a>
                        <ol>
                            <li><a href="#commands">Commands</a></li>
                        </ol>
                    </li>
                    <li><a href="#create-a-place-for-repos">Create a place for repos</a></li>
                    <li><a href="#create-a-dedicated-git-user-and-lock-it-down">Create a dedicated ‚Äúgit‚Äù user and lock it down</a></li>
                    <li><a href="#use-the-repo-from-a-developer-machine">Use the repo from a developer machine</a></li>
                    <li><a href="#practical-use-case-1-small-team-sharing-a-central-remote">Practical use case 1: small team sharing a central remote</a></li>
                    <li><a href="#practical-use-case-2-auto-deploy-on-push-post-receive-hook-">Practical use case 2: auto-deploy on push (post-receive hook)</a></li>
                    <li><a href="#practical-use-case-3-mirror-to-github-gitlab-while-keeping-on-prem-as-source-of-truth">Practical use case 3: mirror to GitHub/GitLab while keeping on-prem as source of truth</a></li>
                    <li><a href="#security-and-hygiene-that-actually-helps">Security and hygiene that actually helps</a></li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                    <li><a href="#optional-lightweight-web-ui">Optional lightweight web UI</a></li>
                    <li><a href="#quick-reference-do-these-in-order-">Quick reference (do these in order)</a></li>
                </ol>
            </ol>
            <div id="related-articles">
                <h2>Related Articles</h2>
                <ol>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/01_introduction_to_version_control.html">Introduction to Version Control</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/02_create_repository.html">Create Repository</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/03_making_changes.html">Making Changes</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/04_working_with_branches.html">Working with Branches</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/05_head.html">Head</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/06_tags.html">Tags</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/07_stashing_files.html">Stashing Files</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/08_observing_repository.html">Observing Repository</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/09_synchronization.html">Synchronization</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/10_squashing_commits.html">Squashing Commits</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/11_archive.html">Archive</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/12_git_server.html">Git Server</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/13_points_of_confusion.html">Points of Confusion</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/14_branching_strategies.html">Branching Strategies</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/15_mono_and_multi_repo.html">Mono and Multi Repo</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/16_dangerous_commands.html">Dangerous Commands</a></li>
                    <li><a href="https://adamdjellouli.com/articles/git_notes/17_git_internals.html">Git Internals</a></li>
                </ol>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer-columns">
            <div class="footer-column">
                <img alt="Adam Djellouli Symbol" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/symbol.png" />
            </div>
            <div class="footer-column">
                <h2><a href="https://adamdjellouli.com/core/privacy_policy.html" title="Privacy Policy">Our Privacy Policy</a></h2>
                <p>Thank you for visiting my personal website. All content here is free to use, but please remember to be respectful and avoid any misuse of the site. If you‚Äôd like to get in touch, feel free to reach out via my <a href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" title="LinkedIn Profile">LinkedIn profile</a> or connect with me on <a href="https://github.com/djeada" title="GitHub Profile">GitHub</a> if you have technical questions or ideas to share. Wishing you all the best and a fantastic life ahead!</p>
            </div>
            <div class="footer-column">
                <h2>Follow me</h2>
                <ul class="social-media">
                    <li>
                        <a class="fa fa-youtube" href="https://www.youtube.com/channel/UCGPoHTVjMN77wcGknXPHl1Q" target="_blank" title="YouTube">
                        </a>YouTube
                    </li>
                    <li>
                        <a class="fa fa-linkedin" href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" target="_blank" title="LinkedIn">
                        </a>LinkedIn
                    </li>
                    <li>
                        <a class="fa fa-instagram" href="https://www.instagram.com/linuxchallenges/" target="_blank" title="Instagram">
                        </a>Instagram
                    </li>
                    <li>
                        <a class="fa fa-github" href="https://github.com/djeada" title="GitHub">
                        </a>Github
                    </li>
                </ul>
            </div>
        </div>
        <div>
            <p id="copyright">
                ¬© Adam Djellouli. All rights reserved.
            </p>
        </div>
        <script>
            document.getElementById("copyright").innerHTML = "&copy; " + new Date().getFullYear() + " Adam Djellouli. All rights reserved.";
        </script>
        <script src="../../app.js"></script>
    </footer>
    <div id="pdf-spinner-overlay">
        <div class="spinner"></div>
    </div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-cpp.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
jax: ["input/TeX", "output/HTML-CSS"],
extensions: ["tex2jax.js"],
"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] },
tex2jax: { inlineMath: [ ["$", "$"] ], displayMath: [ ["$$","$$"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
messageStyle: "none"
});
</script>
<script async="" id="MathJax-script" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

</html>