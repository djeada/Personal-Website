<!DOCTYPE html>
<html lang="pl">

<head>
    <title>Adam Djellouli - Blog</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" />
    <link rel="icon" href="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/icon.ico">
    <link rel="stylesheet" type="text/css" href="../resources/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie-edge" />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5593122079896089" crossorigin="anonymous"></script>
</head>

<body>
    <nav>
        <a class="logo" href="../index.html">
            <img id="logo-image" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/logo.PNG" alt="Adam Djellouli">
        </a>
        <input id="navbar-toggle" type="checkbox" />
        <ul>
            <li> <a href="../index.html"> Home </a> </li>
            <li> <a href="../core/blog.html" class="active"> Blog </a> </li>
            <li> <a href="../core/tools.html"> Tools </a> </li>
            <li> <a href="../core/projects.html"> Projects </a> </li>
            <li> <a href="../core/resume.html"> Resume </a> </li>
            <li> <a href="../core/about.html"> About </a> </li>
            <button id="dark-mode-button"></button>
        </ul>
    </nav>
    <section id="article-body">

        <h3>Testy jednostkowe</h3>
        <p><i>This article is written in: ğŸ‡µğŸ‡±</i></p>
        <p>Testy jednostkowe sÄ… waÅ¼nym narzÄ™dziem w procesie tworzenia oprogramowania, poniewaÅ¼ pomagajÄ… zapewniÄ‡, Å¼e nasz kod dziaÅ‚a poprawnie i jest odporny na bÅ‚Ä™dy. PozwalajÄ… rÃ³wnieÅ¼ na szybkie wykrycie bÅ‚Ä™dÃ³w, ktÃ³re pojawiÅ‚y siÄ™ w wyniku zmian w kodzie, dziÄ™ki czemu moÅ¼emy je szybko naprawiÄ‡. </p>
        <ul>
            <li>Czerwone testy, czyli testy, ktÃ³re nie przeszÅ‚y, pokazujÄ…, Å¼e coÅ›, co dziaÅ‚aÅ‚o wczeÅ›niej, aktualnie nie dziaÅ‚a. MoÅ¼e to byÄ‡ spowodowane tym, Å¼e zostaÅ‚a wprowadzona jakaÅ› zmiana w kodzie, ktÃ³ra spowodowaÅ‚a, Å¼e test nie zadziaÅ‚aÅ‚ poprawnie. Czerwone testy sÄ… sygnaÅ‚em, Å¼e coÅ› jest nie tak i konieczne jest przeanalizowanie kodu i znalezienie przyczyny problemu.</li>
            <li>Zielone testy, czyli testy, ktÃ³re przeszÅ‚y, pokazujÄ…, Å¼e to, co byÅ‚o sprawdzane w testach dziaÅ‚a poprawnie. Nie oznacza to jednak, Å¼e caÅ‚y program dziaÅ‚a poprawnie - mogÄ… byÄ‡ jeszcze inne fragmenty kodu, ktÃ³re nie zostaÅ‚y sprawdzone w testach i ktÃ³re mogÄ… dziaÅ‚aÄ‡ niepoprawnie. Zielone testy sÄ… waÅ¼ne, poniewaÅ¼ pozwalajÄ… upewniÄ‡ siÄ™, Å¼e kod dziaÅ‚a zgodnie z zaÅ‚oÅ¼eniami, ale nie sÄ… wystarczajÄ…ce do caÅ‚kowitego zabezpieczenia aplikacji przed bÅ‚Ä™dami.</li>
        </ul>
        <p>OgÃ³lnie w Pythonie mamy dwie popularne biblioteki sÅ‚uÅ¼Ä…ce do testÃ³w jednostkowych: <code>unittest</code> i <code>pytest</code>. Obie biblioteki, dajÄ… nam moÅ¼liwoÅ›Ä‡ tworzenia testÃ³w jednostkowych i uruchamiania ich automatycznie, co pozwala na skupienie siÄ™ na kodowaniu i unikniÄ™cie rÄ™cznego testowania kodu. Obie biblioteki sÄ… doÅ›Ä‡ proste w uÅ¼yciu i oferujÄ… duÅ¼e moÅ¼liwoÅ›ci tworzenia i uruchamiania testÃ³w. Ostateczny wybÃ³r biblioteki zaleÅ¼y od indywidualnych potrzeb i preferencji programisty.</p>
        <h4>Unittest</h4>
        <p>Biblioteka ta zostaÅ‚a zbudowana zgodnie z filozofiÄ… programowania obiektowego, co oznacza, Å¼e w kodzie tworzymy klasy i korzystamy z dziedziczenia. Unittest oferuje rÃ³wnieÅ¼ wiele funkcji assert, ktÃ³re pozwalajÄ… na sprawdzenie rÃ³Å¼nych aspektÃ³w dziaÅ‚ania programu.</p>
        <p>PrzykÅ‚ad kodu z uÅ¼yciem unittest:</p>
        <p>
        <div>
            <pre><code class="language-python">import unittest
class TestSMTP(unittest.TestCase):

def smtp_connection(self):
import smtplib
return smtplib.SMTP("smtp.gmail.com", 587, timeout=5)
def test_helo(self):
response_code, msg = self.smtp_connection().ehlo()
self.assertEqual(response_code, 250)

</code></pre>
        </div>
        </p>
        <p>W powyÅ¼szym przykÅ‚adzie tworzymy klasÄ™ TestSMTP, ktÃ³ra dziedziczy po klasie TestCase z biblioteki unittest. W tej klasie zdefiniowaliÅ›my funkcjÄ™ smtp_connection, ktÃ³ra tworzy poÅ‚Ä…czenie z serwerem SMTP, oraz funkcjÄ™ test_helo, ktÃ³ra wywoÅ‚uje metodÄ™ ehlo na poÅ‚Ä…czeniu SMTP i sprawdza, czy otrzymano oczekiwany kod odpowiedzi (250).</p>
        <p>Aby uruchomiÄ‡ testy jednostkowe, wystarczy wywoÅ‚aÄ‡ odpowiednie polecenie w konsoli: </p>
        <p><code>python -m unittest</code></p>
        <h4>Pytest</h4>
        <p>Pytest to rÃ³wnieÅ¼ biblioteka sÅ‚uÅ¼Ä…ca do tworzenia i uruchamiania testÃ³w jednostkowych w jÄ™zyku Python. ZostaÅ‚a zbudowana zgodnie z filozofiÄ… "im proÅ›ciej, tym lepiej", co oznacza, Å¼e nie ma w niej klas i dziedziczenia. Pytest pozwala na tworzenie testÃ³w poprzez definiowanie funkcji oznaczonych adnotacjÄ… @pytest.fixture.</p>
        <p>PrzykÅ‚ad kodu z uÅ¼yciem pytest:</p>
        <p>
        <div>
            <pre><code class="language-python">import pytest
@pytest.fixture
def smtp\_connection():
 import smtplib
 return smtplib.SMTP("smtp.gmail.com", 587, timeout=5)
def test\_helo(smtp\_connection):
 response\_code, msg = smtp\_connection.ehlo()
 assert response\_code == 250
</code></pre>
        </div>
        </p>
        <p>Test skÅ‚ada siÄ™ z dwÃ³ch czÄ™Å›ci: dekoratora <code>@pytest.fixture</code> oraz funkcji testowej <code>test_helo()</code>.</p>
        <p>Dekorator <code>@pytest.fixture</code> mÃ³wi nam, Å¼e funkcja <code>smtp_connection()</code> jest funkcjÄ… pomocniczÄ…, ktÃ³ra zostanie uruchomiona przed kaÅ¼dÄ… funkcjÄ… testowÄ…. W tym przypadku <code>smtp_connection()</code> tworzy obiekt <code>SMTP</code> i zwraca go jako wartoÅ›Ä‡. Funkcja ta nie jest testem jednostkowym, ale sÅ‚uÅ¼y do przygotowania Å›rodowiska testowego.</p>
        <p>Natomiast funkcja testowa <code>test_helo()</code> jest testem jednostkowym. Funkcja ta przyjmuje jako argument obiekt <code>smtp_connection</code>, ktÃ³ry zostaÅ‚ wczeÅ›niej utworzony przez dekorator <code>@pytest.fixture</code>. Funkcja testowa wywoÅ‚uje na tym obiekcie funkcjÄ™ <code>ehlo()</code> i sprawdza, czy kod odpowiedzi oraz wiadomoÅ›Ä‡ zwracana przez funkcjÄ™ sÄ… takie same, jak oczekiwane wartoÅ›ci. JeÅ›li tak, to test zostaje zaliczony, w przeciwnym razie test zostaje uznany za nieudany (tzw. "czerwony test").</p>
        <p>Aby uruchomiÄ‡ testy jednostkowe, wystarczy wywoÅ‚aÄ‡ odpowiednie polecenie w konsoli: </p>
        <p><code>pytest</code></p>
        <h4>KorzyÅ›ci z testÃ³w jednostkowych</h4>
        <ul>
            <li>PomagajÄ… innym programistom zrozumieÄ‡ cel danego fragmentu kodu produkcyjnego.</li>
            <li>Gdy programy sÄ… maÅ‚e, programista moÅ¼e rÄ™cznie sprawdziÄ‡ ich dziaÅ‚anie z kaÅ¼dÄ… modyfikacjÄ…. Wraz ze wzrostem zÅ‚oÅ¼onoÅ›ci, rÄ™czne testowanie wszystkich czÄ™Å›ci programu staje siÄ™ niemoÅ¼liwe. Testy jednostkowe moÅ¼na uruchomiÄ‡ automatycznie.</li>
            <li>WymuszajÄ… separacjÄ™ zadaÅ„ miÄ™dzy poszczegÃ³lnymi fragmentami kodu.</li>
            <li>PozwalajÄ… na szybkie sprawdzenie poprawnoÅ›ci dziaÅ‚ania kodu po dokonaniu zmian w kodzie produkcyjnym.</li>
        </ul>
        <h4>TDD</h4>
        <p>Technika "test driven development" (TDD) to sposÃ³b pisania programÃ³w, w ktÃ³rym testy sÄ… pisane przed kodem produkcyjnym. Proces tworzenia programu skÅ‚ada siÄ™ z trzech etapÃ³w:</p>
        <ol>
            <li>Testy jednostkowe.</li>
            <li>Kod produkcyjny.</li>
            <li>Refkatoryzajca kodu produkcyjnego.</li>
        </ol>
        <p>Programista nigdy nie przechodzi do implementacji nowych funkcjonalnoÅ›ci, dopÃ³ki wszystkie trzy etapy nie zostaÅ‚y zakoÅ„czone dla aktualnie implementowanych funkcjonalnoÅ›ci.</p>
        <h4>Losowe dane nie majÄ… miejsca w testach</h4>
        <p>ZaÅ‚Ã³Å¼my, Å¼e masz wÅ‚asnÄ… implementacjÄ™ jednego z algorytmÃ³w sortowania. JeÅ›li chcesz porÃ³wnaÄ‡ wynik jego dziaÅ‚ania, z wynikiem dziaÅ‚ania funkcji <code>sorted()</code> z biblioteki standardowej to rÄ™cznie przygotuj listy wejÅ›ciowe.</p>
        <p>
        <div>
            <pre><code class="language-python">import pytest
def test\_wlasne\_sortowanie():
 lista\_a = [1, 1, 1]
 lista\_b = [3, 5, 2]
 lista\_c = [-1, 2, 3, -1, 0]

 # import random

 # lista\_d = [random.randint(-10, 10) for \_ in range(5)] # ZLE

assert wlasne_sortowanie(lista_a) == sorted(lista_a)
assert wlasne_sortowanie(lista_b) == sorted(lista_b)
assert wlasne_sortowanie(lista_c) == sorted(lista_c)

</code></pre>
        </div>
        </p>
        <p>PowyÅ¼szy fragment kodu zawiera przykÅ‚ad uÅ¼ycia pytest do testowania funkcji <code>wlasne_sortowanie</code>. W tym przypadku, trzy listy sÄ… tworzone jako dane wejÅ›ciowe: <code>lista_a</code>, <code>lista_b</code> i <code>lista_c</code>. NastÄ™pnie sÄ… one porÃ³wnywane z oczekiwanymi wynikami po wywoÅ‚aniu funkcji <code>sorted()</code> na tych samych danych wejÅ›ciowych za pomocÄ… polecenia <code>assert</code>. JeÅ›li wynik zwrÃ³cony przez <code>wlasne_sortowanie()</code> jest rÃ³Å¼ny od oczekiwanego wyniku, zostanie wygenerowany bÅ‚Ä…d, ktÃ³ry poinformuje o niepowodzeniu testu.</p>
        <h4>Od znalezienia buga do poprawnie dziaÅ‚ajÄ…cego kodu</h4>
        <p>ZauwaÅ¼ono bÅ‚Ä…d w twoim programie. Co naleÅ¼y zrobiÄ‡?</p>
        <ol>
            <li>PrÃ³buj odtworzyÄ‡ problematycznÄ… sytuacjÄ™. Na przykÅ‚ad, jeÅ›li twoja aplikacja zamyka siÄ™ po wciÅ›niÄ™ciu przycisku majÄ…cego przenieÅ›Ä‡ uÅ¼ytkownika na innÄ… stronÄ™, najpierw manualnie wykonaj wszystkie kroki prowadzÄ…ce do pojawienia siÄ™ niechcianego efektu.</li>
            <li>Zlokalizuj w kodzie, ktÃ³ry fragment jest odpowiedzialny za pojawienie siÄ™ znalezionego bÅ‚Ä™du.</li>
            <li>Dodaj test, ktÃ³ry sprawdzi, czy niepoÅ¼Ä…dana sytuacja wystÄ™puje po wykonaniu zlokalizowanego fragmentu kodu. Na przykÅ‚ad, jeÅ›li bÅ‚Ä…d pojawia siÄ™ po wywoÅ‚aniu funkcji <code>foo()</code>, najpierw znajdÅº test <code>test_foo()</code> i upewnij siÄ™, Å¼e funkcja <code>foo()</code> jest wywoÅ‚ywana z parametrami, przy ktÃ³rych pojawia siÄ™ bÅ‚Ä…d. Dodaj test wykrywajÄ…cy wystÄ…pienie niepoÅ¼Ä…danej sytuacji. Po uruchomieniu testu otrzymasz czerwony komunikat. </li>
            <li>W kolejnym kroku przyjdzie ci naprawiÄ‡ funkcjÄ™ <code>foo()</code>. MoÅ¼esz to zrobiÄ‡ na rÃ³Å¼ne sposoby, ale pamiÄ™taj, Å¼e celem jest zamienienie czerwonego komunikatu z testu na zielony. MoÅ¼esz zmieniÄ‡ sposÃ³b dziaÅ‚ania funkcji, zmieniÄ‡ sposÃ³b przekazywania argumentÃ³w lub wyeliminowaÄ‡ jakiÅ› bÅ‚Ä…d. WaÅ¼ne, by po zmianach test <code>test_foo()</code> przeszedÅ‚ pomyÅ›lnie.</li>
            <li>Gdy test przechodzi pomyÅ›lnie, moÅ¼esz przejÅ›Ä‡ do kolejnego etapu, czyli refaktoryzacji kodu. To etap, w ktÃ³rym dbamy o to, by kod byÅ‚ czytelny, elegancki i Å‚atwy do zrozumienia. MoÅ¼e to oznaczaÄ‡ przemianowanie zmiennych, zmianÄ™ sposobu ich deklaracji, a nawet usuniÄ™cie niepotrzebnych linii kodu. Refaktoryzacja powinna byÄ‡ przeprowadzana zgodnie z zasadami zdrowego rozsÄ…dku i nie powinna wpÅ‚ywaÄ‡ na poprawnoÅ›Ä‡ funkcji.</li>
            <li>W przyszÅ‚oÅ›ci dbaj o to, by test juÅ¼ zawsze pozostaÅ‚ zielony.</li>
        </ol>
        <h4>Inne typy testÃ³w</h4>
        <ul>
            <li>Testy jednostkowe to testy sprawdzajÄ…ce odizolowane jednostki kodu, najczÄ™Å›ciej pojedyncze funkcje.</li>
            <li>Testy integracyjne to testy sprawdzajÄ…ce, jak rÃ³Å¼ne elementy systemu wspÃ³Å‚pracujÄ… ze sobÄ….</li>
            <li>Testy caÅ‚ego systemu (end-to-end) to testy sprawdzajÄ…ce, jak system dziaÅ‚a jako caÅ‚oÅ›Ä‡, od wejÅ›cia aÅ¼ do wyjÅ›cia.</li>
        </ul>
        <p>OgÃ³lnie rzecz biorÄ…c, im mniej testÃ³w jednostkowych, tym wiÄ™cej testÃ³w integracyjnych i testÃ³w caÅ‚ego systemu jest potrzebnych, aby zapewniÄ‡ odpowiedni poziom testowania. WaÅ¼ne jest, aby zachowaÄ‡ odpowiedni balans miÄ™dzy rÃ³Å¼nymi typami testÃ³w.</p>
        <p>Zgodnie z zaleceniami autora <a href="https://www.oreilly.com/library/view/software-engineering-at/9781492082781/">"Software Engineering at Google"</a> testy naleÅ¼y rozdzieliÄ‡ w nastÄ™pujÄ…cych proporcjach:</p>
        <ul>
            <li>80% testy jednostkowe</li>
            <li>15% testy integracyjne</li>
            <li>5% testy caÅ‚ego systemu (end-to-end)</li>
        </ul>
        <h4>Generowanie danych testowych automatycznie</h4>
        <p>Przy tworzeniu aplikacji, warto rÃ³wnieÅ¼ zadbaÄ‡ o skrypty generujÄ…ce dane testowe, ktÃ³re sÄ… potrzebne do pracy aplikacji. Na przykÅ‚ad, jeÅ›li piszesz aplikacjÄ™ komunikujÄ…cÄ… siÄ™ z bazÄ… danych MySQL, powinieneÅ› mieÄ‡ skrypt, ktÃ³ry automatycznie utworzy takÄ… bazÄ™ danych i wypeÅ‚ni jÄ… przykÅ‚adowymi danymi. DziÄ™ki temu, podczas pisania kodu, moÅ¼esz od razu sprawdziÄ‡, czy dziaÅ‚a on poprawnie, bez koniecznoÅ›ci czekania na uruchomienie testÃ³w w Å›rodowisku produkcyjnym. Ponadto, masz moÅ¼liwoÅ›Ä‡ automatycznego testowania caÅ‚ej aplikacji.</p>
        <h4>Organizacja projektu z testami</h4>
        <p>Aby zachowaÄ‡ porzÄ…dek w projekcie, warto rozdzieliÄ‡ kod produkcyjny i testy jednostkowe do osobnych folderach. W ten sposÃ³b Å‚atwiej bÄ™dzie zarzÄ…dzaÄ‡ plikami i szybko odnaleÅºÄ‡ potrzebne testy.</p>
        <p>PrzykÅ‚adowo, struktura projektu moÅ¼e wyglÄ…daÄ‡ nastÄ™pujÄ…co:</p>
        <p><code>bash
                projekt
                â”œâ”€â”€ przykladowy_pakiet
                â”‚ â”œâ”€â”€ __init__.py
                â”‚ â””â”€â”€ modul_a.py
                â”‚ â””â”€â”€ modul_b.py
                â””â”€â”€ tests
                â”œâ”€â”€ __init__.py
                â””â”€â”€ test_modul_a.py
                â””â”€â”€ test_modul_b.py</code></p>
        <p>W ten sposÃ³b z jednej strony ograniczymy wielkoÅ›Ä‡ plikÃ³w z testami, a z drugiej strony uÅ‚atwimy wszystkim Å¼ycie, gdyÅ¼ znacznie Å‚atwiej bÄ™dzie zlokalizowaÄ‡ konkretny test.</p>
        <h4>Automatyzacja testÃ³w</h4>
        <p>W momencie, gdy nasz projekt zaczyna rosnÄ…Ä‡ w skali, warto zastanowiÄ‡ siÄ™ nad automatyzacjÄ… testÃ³w. MoÅ¼liwe opcje to uÅ¼ycie narzÄ™dzi takich jak <a href="https://travis-ci.org/">Travis CI</a>, <a href="https://jenkins.io/">Jenkins</a>, czy <a href="https://circleci.com/">CircleCI</a>. DziÄ™ki temu kaÅ¼dorazowa zmiana w kodzie ÅºrÃ³dÅ‚owym automatycznie uruchamia wszystkie testy, dziÄ™ki czemu mamy pewnoÅ›Ä‡, Å¼e zmiany nie zepsuÅ‚y istniejÄ…cej funkcjonalnoÅ›ci.</p>
        <p>Automatyzacja testÃ³w to takÅ¼e dobre rozwiÄ…zanie, gdy nie chcemy traciÄ‡ czasu na rÄ™czne wykonywanie testÃ³w na wszystkich moÅ¼liwych platformach i przeglÄ…darkach. W takim przypadku warto zainwestowaÄ‡ w narzÄ™dzia do testowania aplikacji w rÃ³Å¼nych przeglÄ…darkach i systemach operacyjnych, takie jak <a href="https://www.selenium.dev/">Selenium</a>.</p>

    </section>
    <footer>
        <div class="footer-columns">
            <div class="footer-column">
                <img src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/symbol.png" alt="Adam Djellouli">

            </div>
            <div class="footer-column">

                <p>
                    Thank you for visiting my personal website. All of the </br>
                    content on this site is free to use, but please remember </br>
                    to be a good human being and refrain from any abuse</br>
                    of the site. If you would like to contact me, please use </br>
                    my LinkedIn profile or my GitHub if you have any technical </br>
                    issues or ideas to share. I wish you the best and hope you </br>
                    have a fantastic life. </br>
                </p>

            </div>
            <div class="footer-column">
                <h2>Follow me</h2>
                <ul class="social-media">
                    <li>
                        <a href="https://www.youtube.com/channel/UCGPoHTVjMN77wcGknXPHl1Q" class="fa fa-youtube" target="_blank">

                        </a>YouTube
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" class="fa fa-linkedin" target="_blank">

                        </a>LinkedIn
                    </li>
                    <li>
                        <a href="https://www.instagram.com/addjellouli/" class="fa fa-instagram" target="_blank">
                        </a>Instagram

                    </li>
                    <li>
                        <a href="https://github.com/djeada" class="fa fa-github">
                        </a>Github

                    </li>

                </ul>
            </div>
        </div>
        <div>
            <p id="copyright">
                &copy; Adam Djellouli. All rights reserved.
            </p>
        </div>
        <script>
            document.getElementById("copyright").innerHTML = "&copy; " + new Date().getFullYear() + " Adam Djellouli. All rights reserved.";
        </script>
        <script src="../app.js"></script>
    </footer>
</body>

</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>