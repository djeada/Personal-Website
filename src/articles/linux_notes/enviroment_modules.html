<!DOCTYPE html>

<html lang="en">

<head>
    <script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5593122079896089"></script>
    <meta charset="utf-8" />
    <title>Environment Modules</title>
    <meta content="Environment Modules is a powerful and flexible tool that enables dynamic modification of a user's environment via modulefiles." name="description" />
    <meta content="Adam Djellouli" name="author" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <link crossorigin="" href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/icon.ico" rel="icon" />
    <link href="../../resources/style.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
</head>

<body>
    <nav aria-label="Main navigation">
        <a class="logo" href="https://adamdjellouli.com">
            <img alt="Adam Djellouli - Home Page Logo" id="logo-image" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/logo.PNG" />
        </a>
        <input aria-label="Toggle navigation menu" id="navbar-toggle" type="checkbox" />
        <ul aria-labelledby="navbar-toggle" role="menu">
            <li role="menuitem">
                <a href="../../index.html" title="Go to Home Page"> Home </a>
            </li>
            <li role="menuitem">
                <a class="active" href="../../core/blog.html" title="Read Adam Djellouli Blog on Programming and Technology"> Blog </a>
            </li>
            <li role="menuitem">
                <a href="../../core/tools.html" title="Discover Tools Created by Adam Djellouli"> Tools </a>
            </li>
            <li role="menuitem">
                <a href="../../core/projects.html" title="Explore Projects Developed by Adam Djellouli"> Projects </a>
            </li>
            <li role="menuitem">
                <a href="../../core/resume.html" title="View Adam Djellouli Professional Resume"> Resume </a>
            </li>
            <li>
                <script async="" src="https://cse.google.com/cse.js?cx=8160ef9bb935f4f68"></script>
                <div class="gcse-search"></div>
            </li>
            <li>
                <button aria-label="Toggle dark mode" id="dark-mode-button"></button>
            </li>
        </ul>
    </nav>
    <div id="article-wrapper">
        <section id="article-body">
            <p style="text-align: right;"><i>Last modified: May 24, 2022</i></p>
            <p style="text-align: right;"><i>This article is written in: ðŸ‡ºðŸ‡¸</i></p>
            <h2 id="environment-modules">Environment Modules</h2>
            <p>Environment Modules is a powerful and flexible tool that enables dynamic modification of a user's environment via modulefiles. Each modulefile contains the information necessary to configure the shell for a specific application or version, allowing users to seamlessly switch between different software environments. This utility is essential in complex computing environments, such as high-performance computing (HPC) clusters, where managing multiple software packages and versions can be challenging.</p>
            <p>Environment Modules simplifies this process by handling environment variables like <code>PATH</code>, <code>LD_LIBRARY_PATH</code>, and others, ensuring that users can load and unload applications as needed without conflicts or compatibility issues. It promotes efficient use of system resources and enhances productivity by providing a consistent and user-friendly interface for environment management.</p>
            <p>Main idea:</p>
            <ul>
                <li>Load and unload software environments on-the-fly.</li>
                <li>Easily switch between different versions of software packages.</li>
                <li>Automatically detect and prevent conflicts between incompatible modules.</li>
                <li>Define complex environment setups using Tcl scripting within modulefiles.</li>
            </ul>
            <h3 id="installing-environment-modules">Installing Environment Modules</h3>
            <p>The installation process for Environment Modules varies depending on your Linux distribution. Below are the instructions for different systems:</p>
            <h4 id="debian-based-systems-e-g-ubuntu-">Debian-based Systems (e.g., Ubuntu)</h4>
            <p>Update the package list and install Environment Modules:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo apt update
sudo apt install environment-modules</code></pre>
            </div>
            </p>
            <h4 id="red-hat-based-systems-e-g-centos-rhel-fedora-">Red Hat-based Systems (e.g., CentOS, RHEL, Fedora)</h4>
            <p>Use <code>yum</code> or <code>dnf</code> to install Environment Modules:</p>
            <p>
            <div>
                <pre><code class="language-bash"># For CentOS/RHEL
sudo yum install environment-modules

# For Fedora
sudo dnf install environment-modules</code></pre>
            </div>
            </p>
            <h4 id="suse-based-systems-e-g-opensuse-">SUSE-based Systems (e.g., openSUSE)</h4>
            <p>Install using <code>zypper</code>:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo zypper install environment-modules</code></pre>
            </div>
            </p>
            <h4 id="installing-environment-modules-from-source">Installing Environment Modules from Source</h4>
            <p>If the Environment Modules package is not available through your operating systemâ€™s package manager, or if you require a specific version, you can install it directly from the source. This approach provides greater flexibility, particularly if you want to install a newer or custom version.</p>
            <p>I. <strong>Download the Latest Version:</strong></p>
            <p>First, download the source code from the official Environment Modules repository on SourceForge. The following example uses <code>wget</code> to fetch version 4.7.1, but be sure to replace the URL with the latest version if needed:</p>
            <p>
            <div>
                <pre><code class="language-bash">wget https://sourceforge.net/projects/modules/files/Modules/modules-4.7.1/modules-4.7.1.tar.gz
tar -xzf modules-4.7.1.tar.gz
cd modules-4.7.1</code></pre>
            </div>
            </p>
            <ul>
                <li><code>wget</code> is a command-line tool used to download files from the internet.</li>
                <li>The <code>tar -xzf</code> command extracts the downloaded <code>.tar.gz</code> archive, unzipping it into a directory named <code>modules-4.7.1</code>.</li>
                <li><code>cd modules-4.7.1</code> changes to this directory, where the source code is located, preparing for the installation steps.</li>
            </ul>
            <p>II. <strong>Configure and Install:</strong></p>
            <p>After extracting the source, youâ€™ll need to configure the build settings and then compile and install the software:</p>
            <p>
            <div>
                <pre><code class="language-bash">./configure --prefix=/usr/local/modules
make
sudo make install</code></pre>
            </div>
            </p>
            <ul>
                <li><code>./configure --prefix=/usr/local/modules</code> initiates the configuration process and specifies the installation prefix. By setting the <code>--prefix</code> option, you control where the software will be installed; in this case, <code>/usr/local/modules</code>. You can customize this path as needed.</li>
                <li><code>make</code> compiles the source code, creating the binaries that will be installed. This step may take a few minutes depending on your system.</li>
                <li><code>sudo make install</code> installs the compiled software to the specified prefix directory. This command requires <code>sudo</code> because it installs files in system directories that need root privileges.</li>
            </ul>
            <p>III. <strong>Configure Shell Initialization:</strong></p>
            <p>To make the <code>module</code> command available in your shell, you need to add a line to your shell initialization file. This line loads the Environment Modules system each time you open a new shell session:</p>
            <p>
            <div>
                <pre><code class="language-bash">echo "source /usr/local/modules/init/bash" &gt;&gt; ~/.bashrc</code></pre>
            </div>
            </p>
            <ul>
                <li>This command appends the <code>source</code> line to your <code>~/.bashrc</code> file, ensuring the modules system is initialized whenever you start a new shell.</li>
                <li>Adjust <code>bash</code> in the path if you use a different shell, such as <code>zsh</code> or <code>tcsh</code>. For example, if you use <code>zsh</code>, the line would be: <code>source /usr/local/modules/init/zsh</code>.</li>
            </ul>
            <p>To apply these changes immediately, either log out and back in or reload your shell configuration:</p>
            <p>
            <div>
                <pre><code class="language-bash">source ~/.bashrc</code></pre>
            </div>
            </p>
            <p>This command applies the new configuration without requiring a logout, so you can start using Environment Modules right away. Now you should be able to run the <code>module</code> command and manage software modules as needed.</p>
            <h3 id="working-with-environment-module-files">Working with Environment Module Files</h3>
            <p>Modulefiles are scripts written in the Tcl language that define how to modify the environment for a specific application. They are typically stored in directories specified by the <code>MODULEPATH</code> environment variable, such as <code>/usr/share/modules/modulefiles</code> or <code>/etc/modulefiles</code>.</p>
            <h4 id="example-modulefile-directory">Example Modulefile Directory</h4>
            <p>Here's an example of what a directory tree structure might look like for a collection of modulefiles organized for various applications and versions. Each application has its own subdirectory, and within that, modulefiles for specific versions are stored. Additionally, a <code>.version</code> file or symbolic link might be present to specify the default version.</p>
            <p>
            <div>
                <pre><code class="language-shell">/etc/modulefiles
â”œâ”€â”€ python
â”‚   â”œâ”€â”€ 2.7
â”‚   â”œâ”€â”€ 3.6
â”‚   â”œâ”€â”€ 3.8
â”‚   â””â”€â”€ .version
â”œâ”€â”€ gcc
â”‚   â”œâ”€â”€ 8.4.0
â”‚   â”œâ”€â”€ 9.3.0
â”‚   â””â”€â”€ 10.2.0
â”œâ”€â”€ my_app
â”‚   â”œâ”€â”€ 1.0
â”‚   â”œâ”€â”€ 2.1
â”‚   â”œâ”€â”€ 2.2
â”‚   â””â”€â”€ default -&gt; 2.1
â”œâ”€â”€ cuda
â”‚   â”œâ”€â”€ 10.1
â”‚   â”œâ”€â”€ 11.0
â”‚   â””â”€â”€ .version
â”œâ”€â”€ openmpi
â”‚   â”œâ”€â”€ 3.1.4
â”‚   â”œâ”€â”€ 4.0.5
â”‚   â””â”€â”€ 4.1.0
â””â”€â”€ cmake
    â”œâ”€â”€ 3.17
    â”œâ”€â”€ 3.18
    â””â”€â”€ .version</code></pre>
            </div>
            </p>
            <p>This structure provides organization and makes it easy to manage multiple versions of different software using Environment Modules. Each application has its own directory under <code>/etc/modulefiles</code>, and within those directories, version-specific modulefiles are stored.</p>
            <h4 id="creating-modulefile-directories">Creating Modulefile Directories</h4>
            <p>To organize your modulefiles, itâ€™s a good practice to create a directory structure that reflects the software youâ€™re managing. This makes it easier to maintain and locate modulefiles as your collection grows.</p>
            <p>I. <strong>Create a Directory for Your Application:</strong></p>
            <p>Use the following command to create a new directory for your application within the standard modulefile path:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo mkdir -p /usr/share/modules/modulefiles/my_app</code></pre>
            </div>
            </p>
            <ul>
                <li>The <code>-p</code> flag tells <code>mkdir</code> to create the parent directories if they do not already exist, which helps avoid errors if any intermediate directories are missing.</li>
                <li>Replace <code>my_app</code> with the name of your application, making the modulefile directory structure more organized.</li>
            </ul>
            <p>II. <strong>Set Appropriate Permissions:</strong></p>
            <p>To ensure that users can access the modulefiles, set the correct permissions on the new directory:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo chmod 755 /usr/share/modules/modulefiles/my_app</code></pre>
            </div>
            </p>
            <ul>
                <li>The <code>755</code> permission setting allows the owner to read, write, and execute files in the directory, while others can read and execute files. This is usually suitable for shared module directories, as it allows others to access the files but not modify them.</li>
            </ul>
            <h4 id="writing-a-modulefile-for-a-specific-version">Writing a Modulefile for a Specific Version</h4>
            <p>A modulefile is a simple script that configures the environment for a particular software version. By setting paths and environment variables, a modulefile helps users load the necessary settings for your application without modifying their shell configuration files.</p>
            <p>I. <strong>Create the Modulefile:</strong></p>
            <p>To create a modulefile, use a text editor to open a new file with the version number you want to manage:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo nano /usr/share/modules/modulefiles/my_app/1.0</code></pre>
            </div>
            </p>
            <ul>
                <li>This command creates a file named <code>1.0</code> inside the <code>my_app</code> directory, representing version 1.0 of your application.</li>
                <li>You can replace <code>1.0</code> with any version number, following this naming convention for each version of the software you want to manage with modules.</li>
            </ul>
            <p>II. <strong>Edit the Modulefile:</strong></p>
            <p>Hereâ€™s an example modulefile for <code>my_app</code> version 1.0. The file contains commands that configure the environment whenever the module is loaded.</p>
            <p>
            <div>
                <pre><code class="language-tcl">#%Module1.0#####################################################################
##
## my_app modulefile
##

proc ModulesHelp { } {
   puts stderr "This module loads my_app version 1.0"
}

module-whatis "Loads my_app version 1.0"

# Set the installation prefix
set root /opt/my_app/1.0

# Modify environment variables
prepend-path PATH $root/bin
prepend-path LD_LIBRARY_PATH $root/lib
prepend-path MANPATH $root/share/man

# Set custom environment variables
setenv MY_APP_HOME $root

# Handle conflicts with other versions
conflict my_app</code></pre>
            </div>
            </p>
            <ul>
                <li><strong>proc ModulesHelp { }</strong>: Defines a function that outputs a help message when the <code>module help my_app/1.0</code> command is run. This is useful for providing users with a brief description of what the module does.</li>
                <li><strong>module-whatis</strong>: This command specifies a one-line summary of the module, displayed when users run <code>module whatis my_app/1.0</code>. It helps users quickly identify what this modulefile does.</li>
                <li><strong>set root</strong>: The <code>set</code> command defines a variable (<code>root</code>) that points to the installation directory of your application. This makes the modulefile easier to update, as you can adjust the path in one place if needed.</li>
                <li>The <strong>prepend-path</strong> command adds directories to various environment variables by placing a new directory at the beginning of each specified path. For example, it adds <code>$root/bin</code> to <code>PATH</code>, so the shell can locate the application's executables; <code>$root/lib</code> to <code>LD_LIBRARY_PATH</code>, enabling the linker to find the applicationâ€™s libraries; and <code>$root/share/man</code> to <code>MANPATH</code>, allowing the <code>man</code> command to access the applicationâ€™s manual pages.</li>
                <li><strong>setenv</strong>: This command defines a custom environment variable <code>MY_APP_HOME</code>, which points to the root directory of the application. Users can reference this variable directly, which can be helpful for scripts or commands related to the application.</li>
                <li><strong>conflict</strong>: This command prevents users from loading multiple versions of <code>my_app</code> at the same time. If a user tries to load a second version without first unloading the current one, the module system will display an error message. This ensures that only one version of the application is loaded, avoiding potential conflicts.</li>
            </ul>
            <p>III. <strong>Save and Exit:</strong></p>
            <p>After editing the modulefile, save and close the editor:</p>
            <ul>
                <li>Press <code>Ctrl + O</code> to save your changes.</li>
                <li>Press <code>Ctrl + X</code> to exit <code>nano</code>.</li>
            </ul>
            <h3 id="managing-the-modulepath-variable">Managing the MODULEPATH Variable</h3>
            <p>The <code>MODULEPATH</code> environment variable tells the <code>module</code> command where to look for available modulefiles. By adjusting <code>MODULEPATH</code>, you can customize where the module system searches for additional modules, allowing you to access modulefiles that may not be in the default path.</p>
            <p>I. <strong>Add to MODULEPATH Temporarily:</strong></p>
            <p>To add a directory to <code>MODULEPATH</code> for your current session only, use the <code>module use</code> command:</p>
            <p>
            <div>
                <pre><code class="language-bash">module use /usr/share/modules/modulefiles</code></pre>
            </div>
            </p>
            <p>This command tells the module system to include <code>/usr/share/modules/modulefiles</code> when searching for available modulefiles. However, it only applies to the current terminal session. Once you log out or close the terminal, the addition to <code>MODULEPATH</code> is reset.</p>
            <p>II. <strong>Add to MODULEPATH Permanently:</strong></p>
            <p>To make the change permanent, add the <code>module use</code> line to your shell initialization file, such as <code>~/.bashrc</code> (for Bash users). This ensures the path is always added when you open a new terminal:</p>
            <p>
            <div>
                <pre><code class="language-bash">echo "module use /usr/share/modules/modulefiles" &gt;&gt; ~/.bashrc
source ~/.bashrc</code></pre>
            </div>
            </p>
            <h3 id="usage-of-the-module-command">Usage of the <code>module</code> Command</h3>
            <p>The <code>module</code> command provides several subcommands to interact with environment modules. These subcommands allow you to load, unload, list, display, switch, and manage module configurations.</p>
            <h4 id="loading-modules">Loading Modules</h4>
            <p>I. <strong>Load a Module:</strong></p>
            <p>To load a module and make its associated software available for use:</p>
            <p>
            <div>
                <pre><code class="language-bash">module load my_app</code></pre>
            </div>
            </p>
            <p>This command loads the specified module and updates environment variables such as <code>PATH</code>, <code>LD_LIBRARY_PATH</code>, or other variables defined by the modulefile. If multiple versions of a module exist and no default is set, you may need to specify the desired version:</p>
            <p>
            <div>
                <pre><code class="language-bash">module load my_app/1.0</code></pre>
            </div>
            </p>
            <p>II. <strong>Load Multiple Modules:</strong></p>
            <p>To load multiple modules at once, separate each module name with a space:</p>
            <p>
            <div>
                <pre><code class="language-bash">module load gcc/9.3.0 openmpi/4.0.5 my_app/1.0</code></pre>
            </div>
            </p>
            <p>This example loads the GCC compiler, the Open MPI library, and <code>my_app</code>. Modules are loaded in the order specified, which can be important if later modules depend on those loaded earlier.</p>
            <h4 id="unloading-modules">Unloading Modules</h4>
            <p>I. <strong>Unload a Module:</strong></p>
            <p>To remove a module from your environment and reset any associated environment variables:</p>
            <p>
            <div>
                <pre><code class="language-bash">module unload my_app</code></pre>
            </div>
            </p>
            <p>This command removes the specified module's changes from the environment, effectively "unloading" it.</p>
            <p>II. <strong>Unload Multiple Modules:</strong></p>
            <p>You can also unload multiple modules at once by listing them with spaces:</p>
            <p>
            <div>
                <pre><code class="language-bash">module unload gcc openmpi my_app</code></pre>
            </div>
            </p>
            <p>This is useful for clearing several modules without removing all loaded modules.</p>
            <h4 id="listing-modules">Listing Modules</h4>
            <p>I. <strong>List Loaded Modules:</strong></p>
            <p>To view a list of all currently loaded modules:</p>
            <p>
            <div>
                <pre><code class="language-bash">module list</code></pre>
            </div>
            </p>
            <p>This command displays the names and versions of each module currently loaded into your environment.</p>
            <p>II. <strong>List Available Modules:</strong></p>
            <p>To see a list of all modules available for loading, use:</p>
            <p>
            <div>
                <pre><code class="language-bash">module avail</code></pre>
            </div>
            </p>
            <p>If you want to filter the results, you can specify part of a module name or a pattern:</p>
            <p>
            <div>
                <pre><code class="language-bash">module avail my_app</code></pre>
            </div>
            </p>
            <p>This command will show only those modules that match <code>my_app</code>.</p>
            <h4 id="displaying-module-information">Displaying Module Information</h4>
            <p>I. <strong>Show Module Details:</strong></p>
            <p>To view detailed information about a specific module, including the environment variables it modifies:</p>
            <p>
            <div>
                <pre><code class="language-bash">module show my_app/1.0</code></pre>
            </div>
            </p>
            <p>This command displays the modulefileâ€™s contents and how it affects your environment, helping you understand what it changes when loaded.</p>
            <p>II. <strong>Get Help for a Module:</strong></p>
            <p>Some modules include a help message to provide additional usage information. To access this help:</p>
            <p>
            <div>
                <pre><code class="language-bash">module help my_app/1.0</code></pre>
            </div>
            </p>
            <h4 id="switching-between-modules">Switching Between Modules</h4>
            <p>If you want to replace one version of a module with another, you can use <code>module switch</code>:</p>
            <p>
            <div>
                <pre><code class="language-bash">module switch my_app/1.0 my_app/2.0</code></pre>
            </div>
            </p>
            <p>This command unloads the first module and immediately loads the second, effectively switching between versions.</p>
            <h4 id="purging-modules">Purging Modules</h4>
            <p>The <code>module purge</code> command removes all loaded modules from your environment:</p>
            <p>
            <div>
                <pre><code class="language-bash">module purge</code></pre>
            </div>
            </p>
            <p>This is useful when you need a clean environment but should be used with caution, as it will unload every loaded module, including those you may still need.</p>
            <h4 id="saving-and-restoring-module-sets">Saving and Restoring Module Sets</h4>
            <p>I. <strong>Save Current Module Set:</strong></p>
            <p>To save your current set of loaded modules, use:</p>
            <p>
            <div>
                <pre><code class="language-bash">module save my_default_modules</code></pre>
            </div>
            </p>
            <p>This creates a named set of modules that you can reload later, making it easy to return to a specific configuration.</p>
            <p>II. <strong>Restore Module Set:</strong></p>
            <p>To reload a saved module set, use:</p>
            <p>
            <div>
                <pre><code class="language-bash">module restore my_default_modules</code></pre>
            </div>
            </p>
            <p>This command reloads all the modules saved under the specified name, allowing you to quickly set up your environment.</p>
            <p>III. <strong>List Saved Module Sets:</strong></p>
            <p>To view a list of all saved module sets:</p>
            <p>
            <div>
                <pre><code class="language-bash">module savelist</code></pre>
            </div>
            </p>
            <p>This displays the names of all saved sets, helping you remember what configurations youâ€™ve saved for later use.</p>
            <h3 id="example-switching-between-python-versions">Example: Switching Between Python Versions</h3>
            <p>Environment Modules is especially useful when you need to switch between different versions of the same software. For example, you may need to switch between Python 2.7 and Python 3.8 for different projects. The steps below illustrate how you can use Environment Modules to handle this task.</p>
            <h4 id="i-create-a-directory-for-python-modulefiles">I. Create a directory for Python modulefiles</h4>
            <p>First, you need a directory where your Python module files will reside. This is typically located in <code>/etc/modulefiles/</code>, but you can adjust the path based on your systemâ€™s configuration. Create a directory for Python modulefiles:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo mkdir /etc/modulefiles/python</code></pre>
            </div>
            </p>
            <p>This command creates a directory <code>/etc/modulefiles/python</code>, where you'll store the configuration files for different Python versions.</p>
            <h4 id="ii-create-and-configure-a-modulefile-for-python-2-7">II. Create and configure a modulefile for Python 2.7</h4>
            <p>Next, create a modulefile for Python 2.7. A modulefile is essentially a script that modifies environment variables like <code>PATH</code> and <code>LD_LIBRARY_PATH</code> to make the specific Python version available in your environment.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo touch /etc/modulefiles/python/2.7
sudo nano /etc/modulefiles/python/2.7</code></pre>
            </div>
            </p>
            <p>The <code>touch</code> command creates an empty file named <code>2.7</code>, and <code>nano</code> opens it for editing.</p>
            <h4 id="iii-edit-the-modulefile-for-python-2-7">III. Edit the modulefile for Python 2.7</h4>
            <p>In the opened <code>nano</code> editor, add the necessary lines that define how the environment should be configured when the Python 2.7 module is loaded. Be sure to modify the <code>prepend-path</code> lines based on the actual location of Python 2.7 on your system.</p>
            <p>
            <div>
                <pre><code class="language-bash">#%Module 1.0
##
##  Module for the Python 2.7 programming language.
##

module-whatis "Module for Python 2.7"

prepend-path PATH /usr/local/python2.7/bin
prepend-path LD_LIBRARY_PATH /usr/local/python2.7/lib
conflict python</code></pre>
            </div>
            </p>
            <ul>
                <li><code>module-whatis</code> provides a short description of the module.</li>
                <li><code>prepend-path PATH</code> ensures that the directory containing the Python 2.7 binary is placed at the front of your <code>PATH</code> environment variable.</li>
                <li><code>prepend-path LD_LIBRARY_PATH</code> adds the directory containing Python 2.7 libraries to <code>LD_LIBRARY_PATH</code>.</li>
                <li><code>conflict python</code> ensures that only one Python version is loaded at a time, preventing conflicts.</li>
            </ul>
            <p>Save the file and exit <code>nano</code> by pressing <code>CTRL + X</code>, then <code>Y</code>, and <code>Enter</code>.</p>
            <h4 id="iv-create-and-configure-a-modulefile-for-python-3-8">IV. Create and configure a modulefile for Python 3.8</h4>
            <p>Similarly, you need to create a modulefile for Python 3.8:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo touch /etc/modulefiles/python/3.8
sudo nano /etc/modulefiles/python/3.8</code></pre>
            </div>
            </p>
            <p>Then, add the following lines to configure Python 3.8. Again, adjust the <code>prepend-path</code> lines based on your systemâ€™s Python 3.8 location.</p>
            <p>
            <div>
                <pre><code class="language-bash">#%Module 1.0
##
##  Module for the Python 3.8 programming language.
##

module-whatis "Module for Python 3.8"

prepend-path PATH /usr/local/python3.8/bin
prepend-path LD_LIBRARY_PATH /usr/local/python3.8/lib
conflict python</code></pre>
            </div>
            </p>
            <p>This modulefile works similarly to the one for Python 2.7, but it's configured for Python 3.8. The <code>conflict python</code> directive ensures that Python 2.7 and Python 3.8 cannot be loaded at the same time.</p>
            <h4 id="v-switch-between-python-versions">V. Switch between Python versions</h4>
            <p>Once the modulefiles are created and configured, you can easily switch between the two Python versions using the <code>module</code> command.</p>
            <p>To load Python 2.7, run:</p>
            <p>
            <div>
                <pre><code class="language-bash">module load python/2.7</code></pre>
            </div>
            </p>
            <p>This will modify your shell environment, updating <code>PATH</code> and <code>LD_LIBRARY_PATH</code> so that Python 2.7 becomes the default.</p>
            <p>If you later need to switch to Python 3.8, first unload Python 2.7, then load Python 3.8:</p>
            <p>
            <div>
                <pre><code class="language-bash">module unload python/2.7
module load python/3.8</code></pre>
            </div>
            </p>
            <p>Unloading Python 2.7 ensures that no conflicting versions are loaded simultaneously.</p>
            <h4 id="vi-verify-the-active-python-version">VI. Verify the active Python version</h4>
            <p>After switching between Python versions, you can verify which version is active by using the following command:</p>
            <p>
            <div>
                <pre><code class="language-bash">python --version</code></pre>
            </div>
            </p>
            <p>This will display the version of Python currently set as default in your environment.</p>
            <h3 id="best-practices">Best Practices</h3>
            <p>I. To ensure reproducibility and avoid unexpected behavior, always specify the version when loading modules.</p>
            <p>
            <div>
                <pre><code class="language-bash">module load my_app/1.0</code></pre>
            </div>
            </p>
            <p>II. While <code>module purge</code> can help reset your environment, it may also unload critical modules. Check which modules are loaded before purging.</p>
            <p>III. Include module load commands in scripts or job submission files to ensure the correct environment is set up for your tasks.</p>
            <p>IV. Be aware of module conflicts, especially when working with compilers and MPI libraries. The <code>conflict</code> command in modulefiles helps prevent incompatible modules from being loaded together.</p>
            <h3 id="advanced-modulefile-techniques">Advanced Modulefile Techniques</h3>
            <p>Environment Modules support Tcl scripting, which allows for advanced features like conditional logic and dynamic behavior. This makes it possible to create more flexible and powerful modulefiles that adapt to the environment in which they are loaded.</p>
            <h4 id="conditional-loading-based-on-environment">Conditional Loading Based on Environment</h4>
            <p>You can use Tcl's scripting features to implement conditional logic within a modulefile. For example, you might want to load specific dependencies only if another module is already loaded.</p>
            <p>
            <div>
                <pre><code class="language-tcl"># Check if a specific module is loaded
if { [ is-loaded gcc/9.3.0 ] } {
    # Load dependencies
    module load dependency_module
} else {
    puts stderr "Error: gcc/9.3.0 must be loaded before my_app."
    exit 1
}</code></pre>
            </div>
            </p>
            <ul>
                <li><code>is-loaded gcc/9.3.0</code>: This checks if the <code>gcc/9.3.0</code> module is already loaded in the environment.</li>
                <li><code>module load dependency_module</code>: Loads a required dependency if the condition is true.</li>
                <li><code>puts stderr</code>: Prints an error message to the standard error if the condition is false.</li>
                <li><code>exit 1</code>: Exits with an error code, signaling a failure due to the unmet condition.</li>
            </ul>
            <p>This ensures that the required dependencies are in place before loading your application module.</p>
            <h4 id="setting-default-modules">Setting Default Modules</h4>
            <p>Administrators can set a default module version so that users automatically load the default version of a module if they donâ€™t specify a specific one. This can be done using either a <code>.version</code> file or a symbolic link.</p>
            <p>I. <strong>Using a <code>.version</code> File:</strong></p>
            <p>You can create a <code>.version</code> file in the application's modulefile directory to define the default version of the module.</p>
            <p>
            <div>
                <pre><code class="language-tcl">#%Module1.0
set ModulesVersion "1.0"</code></pre>
            </div>
            </p>
            <p>The <code>.version</code> file ensures consistency by defaulting to a stable version of the software.</p>
            <p>II. <strong>Using a Symbolic Link:</strong></p>
            <p>Another method to set the default module version is by using symbolic links. This method involves creating a symbolic link named <code>default</code> pointing to the desired version.</p>
            <p>
            <div>
                <pre><code class="language-bash">ln -s 1.0 /usr/share/modules/modulefiles/my_app/default</code></pre>
            </div>
            </p>
            <ul>
                <li><code>ln -s 1.0</code>: Creates a symbolic link named <code>default</code> that points to version <code>1.0</code>.</li>
                <li><code>/usr/share/modules/modulefiles/my_app/default</code>: Specifies the path where the symbolic link will reside, which is the modulefile directory for <code>my_app</code>.</li>
            </ul>
            <p>This approach allows for easy switching of default versions by updating the symbolic link to point to a new version.</p>
            <h3 id="troubleshooting">Troubleshooting</h3>
            <p>Even with well-written modulefiles, users may encounter issues when loading or using modules. Here are common issues and their solutions.</p>
            <p>I. <strong>Module Not Found:</strong></p>
            <p>If the module you are trying to load is not found, it could be due to the modulefile directory not being included in the <code>MODULEPATH</code>. To verify the directories in <code>MODULEPATH</code>, run:</p>
            <p>
            <div>
                <pre><code class="language-bash">echo $MODULEPATH</code></pre>
            </div>
            </p>
            <p>If the desired directory is not listed, you can add it using the following command:</p>
            <p>
            <div>
                <pre><code class="language-bash">module use /path/to/modulefiles</code></pre>
            </div>
            </p>
            <p>Ensure that the correct directory is permanently added if you need it frequently by adding the command to your shell's initialization script (e.g., <code>.bashrc</code> or <code>.bash_profile</code>).</p>
            <p>II. <strong>Environment Variables Not Set:</strong></p>
            <p>If certain environment variables arenâ€™t being set as expected when you load a module, check the modulefile for errors in syntax or incorrect paths. To inspect what a module does when loaded, use the following command:</p>
            <p>
            <div>
                <pre><code class="language-bash">module show &lt;module_name&gt;</code></pre>
            </div>
            </p>
            <p>III. <strong>Conflicts with Other Modules:</strong></p>
            <p>Sometimes, multiple loaded modules can conflict with each other, causing unexpected behavior. If this happens, the easiest solution is to unload all currently loaded modules and start fresh:</p>
            <p>
            <div>
                <pre><code class="language-bash">module purge</code></pre>
            </div>
            </p>
            <p>After purging, you can selectively load the required modules for your task.</p>
            <p>IV. <strong>Module Command Not Found:</strong></p>
            <p>If you receive an error like <code>module: command not found</code>, it indicates that the Environment Modules package is either not installed or not set up properly in your shell environment. To resolve this:</p>
            <ol>
                <li>Ensure that Environment Modules is installed by checking your package manager or manually inspecting the system.</li>
                <li>Ensure that your shell initialization file (e.g., <code>.bashrc</code>, <code>.bash_profile</code>) sources the appropriate environment setup script. For example, for bash, you would typically add:</li>
            </ol>
            <p>
            <div>
                <pre><code class="language-bash">source /usr/share/modules/init/bash</code></pre>
            </div>
            </p>
            <p>This ensures that the <code>module</code> command is available in your shell sessions.</p>
            <h3 id="challenges">Challenges</h3>
            <ol>
                <li>Install the Environment Modules package on your system using the appropriate package manager command for your operating system (e.g., <code>apt install environment-modules</code> for Debian-based systems or <code>yum install environment-modules</code> for CentOS). Explain the purpose of Environment Modules and how they simplify the management of software versions on shared systems.</li>
                <li>Create a directory under <code>/etc/modulefiles</code> for a new application. For example, set up a directory for Python by running <code>sudo mkdir /etc/modulefiles/python</code>. Discuss why <code>/etc/modulefiles</code> is commonly used for storing modulefiles and how it enables centralized module management.</li>
                <li>Select a specific version of the application you plan to manage with environment modules (e.g., Python 3.8), and create a modulefile for this version in the directory you set up. For instance, use <code>sudo touch /etc/modulefiles/python/3.8</code> to create a modulefile. Briefly describe the structure of modulefile directories and the purpose of organizing applications by version.</li>
                <li>Edit the modulefile for the application version you selected, configuring it to load the necessary environment settings. Use the <code>prepend-path</code> directive to add the <code>bin</code> and <code>lib</code> directories to the <code>PATH</code> and <code>LD_LIBRARY_PATH</code> environment variables, respectively. Include the <code>conflict</code> directive to prevent the loading of incompatible versions simultaneously. Discuss how <code>prepend-path</code> and <code>conflict</code> ensure smooth version management.</li>
                <li>Load the application module you created using the <code>module load</code> command, and confirm the module is active by checking the output of <code>module list</code> and verifying the applicationâ€™s version (e.g., <code>python --version</code>). Explain how the <code>module load</code> command modifies the user environment to include the application paths defined in the modulefile.</li>
                <li>Unload the module you just loaded by using the <code>module unload</code> command. Verify that the module has been removed by running <code>module list</code> and checking that the applicationâ€™s paths are no longer in your environment. Discuss why itâ€™s essential to unload modules, especially when switching between different versions.</li>
                <li>Use the <code>module avail</code> command to list all available modules on your system, including the one you created. Explain how the <code>module avail</code> command helps users discover available software and manage multiple applications more effectively.</li>
                <li>Finally, unload all loaded modules using the <code>module purge</code> command, and confirm that no modules remain active by checking the output of <code>module list</code>. Discuss the utility of <code>module purge</code> for resetting the environment and ensuring a clean state before loading other modules.
                    Here are two additional challenges to complete the list, focusing on advanced modulefile customization and persistent module environments:</li>
                <li>Add descriptive metadata to the modulefile, such as a brief description, version information, and any necessary dependencies or prerequisites for the application. Use directives like <code>module-whatis</code> to provide a summary and <code>module help</code> to give users more details when they load the module. Discuss how adding metadata improves module discoverability and provides helpful information for users.</li>
                <li>Set up a persistent module environment by configuring your shell profile (e.g., <code>.bashrc</code> or <code>.bash_profile</code>) to automatically load a specific module or set of modules on login. Test this configuration by logging out and back in, then verifying that the module(s) load automatically. Explain the benefits of persistent module environments for frequent users of specific software.</li>
            </ol>
        </section>
        <div id="table-of-contents">
            <h2>Table of Contents</h2>
            <ol><a href="#environment-modules">Environment Modules</a>
                <ol>
                    <li><a href="#installing-environment-modules">Installing Environment Modules</a>
                        <ol>
                            <li><a href="#debian-based-systems-e-g-ubuntu-">Debian-based Systems (e.g., Ubuntu)</a></li>
                            <li><a href="#red-hat-based-systems-e-g-centos-rhel-fedora-">Red Hat-based Systems (e.g., CentOS, RHEL, Fedora)</a></li>
                            <li><a href="#suse-based-systems-e-g-opensuse-">SUSE-based Systems (e.g., openSUSE)</a></li>
                            <li><a href="#installing-environment-modules-from-source">Installing Environment Modules from Source</a></li>
                        </ol>
                    </li>
                    <li><a href="#working-with-environment-module-files">Working with Environment Module Files</a>
                        <ol>
                            <li><a href="#example-modulefile-directory">Example Modulefile Directory</a></li>
                            <li><a href="#creating-modulefile-directories">Creating Modulefile Directories</a></li>
                            <li><a href="#writing-a-modulefile-for-a-specific-version">Writing a Modulefile for a Specific Version</a></li>
                        </ol>
                    </li>
                    <li><a href="#managing-the-modulepath-variable">Managing the MODULEPATH Variable</a></li>
                    <li><a href="#usage-of-the-module-command">Usage of the module Command</a>
                        <ol>
                            <li><a href="#loading-modules">Loading Modules</a></li>
                            <li><a href="#unloading-modules">Unloading Modules</a></li>
                            <li><a href="#listing-modules">Listing Modules</a></li>
                            <li><a href="#displaying-module-information">Displaying Module Information</a></li>
                            <li><a href="#switching-between-modules">Switching Between Modules</a></li>
                            <li><a href="#purging-modules">Purging Modules</a></li>
                            <li><a href="#saving-and-restoring-module-sets">Saving and Restoring Module Sets</a></li>
                        </ol>
                    </li>
                    <li><a href="#example-switching-between-python-versions">Example: Switching Between Python Versions</a>
                        <ol>
                            <li><a href="#i-create-a-directory-for-python-modulefiles">I. Create a directory for Python modulefiles</a></li>
                            <li><a href="#ii-create-and-configure-a-modulefile-for-python-2-7">II. Create and configure a modulefile for Python 2.7</a></li>
                            <li><a href="#iii-edit-the-modulefile-for-python-2-7">III. Edit the modulefile for Python 2.7</a></li>
                            <li><a href="#iv-create-and-configure-a-modulefile-for-python-3-8">IV. Create and configure a modulefile for Python 3.8</a></li>
                            <li><a href="#v-switch-between-python-versions">V. Switch between Python versions</a></li>
                            <li><a href="#vi-verify-the-active-python-version">VI. Verify the active Python version</a></li>
                        </ol>
                    </li>
                    <li><a href="#best-practices">Best Practices</a></li>
                    <li><a href="#advanced-modulefile-techniques">Advanced Modulefile Techniques</a>
                        <ol>
                            <li><a href="#conditional-loading-based-on-environment">Conditional Loading Based on Environment</a></li>
                            <li><a href="#setting-default-modules">Setting Default Modules</a></li>
                        </ol>
                    </li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                    <li><a href="#challenges">Challenges</a></li>
                </ol>
            </ol>
            <div id="related-articles">
                <h2>Related Articles</h2>
                <ol>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/commands.html">Commands</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/cron_jobs.html">Cron Jobs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/disk_io_analysis.html">Disk Io Analysis</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/disk_usage.html">Disk Usage</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/dwm.html">Dwm</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/encryption.html">Encryption</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/enviroment_modules.html">Enviroment Modules</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/enviroment_variable.html">Enviroment Variable</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/file_system.html">File System</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/files_and_dirs.html">Files and Dirs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/finding_files.html">Finding Files</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/firewall.html">Firewall</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/grep.html">Grep</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/hardware.html">Hardware</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/inodes_and_symlinks.html">Inodes and Symlinks</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/introduction.html">Introduction</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/kernel.html">Kernel</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ldap.html">Ldap</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/log_files_and_journals.html">Log Files and Journals</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/logical_volume_management.html">Logical Volume Management</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/managing_users.html">Managing Users</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/mounting.html">Mounting</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/networking.html">Networking</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/nfs.html">Nfs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/package_managers.html">Package Managers</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/partitions.html">Partitions</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/performance_monitoring.html">Performance Monitoring</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/permissions.html">Permissions</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/pipe_and_redirect.html">Pipe and Redirect</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ports.html">Ports</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/processes.html">Processes</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/running_executables.html">Running Executables</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/sed_and_awk.html">Sed and Awk</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/selinux.html">Selinux</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/services.html">Services</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/shells_and_bash_configuration.html">Shells and Bash Configuration</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ssh_and_scp.html">Ssh and Scp</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/system_startup.html">System Startup</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/tar_and_gzip.html">Tar and Gzip</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/task_state_analysis.html">Task State Analysis</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/utilities.html">Utilities</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/virtual_machines.html">Virtual Machines</a></li>
                </ol>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer-columns">
            <div class="footer-column">
                <img alt="Adam Djellouli Symbol" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/symbol.png" />
            </div>
            <div class="footer-column">
                <h2><a href="https://adamdjellouli.com/core/privacy_policy.html" title="Privacy Policy">Our Privacy Policy</a></h2>
                <p>
                    Thank you for visiting my personal website. All of the <br />
                    content on this site is free to use, but please remember <br />
                    to be a good human being and refrain from any abuse<br />
                    of the site. If you would like to contact me, please use <br />
                    my <a href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" title="LinkedIn Profile">LinkedIn profile</a> or my <a href="https://github.com/djeada" title="GitHub Profile">GitHub</a> if you have any technical <br />
                    issues or ideas to share. I wish you the best and hope you <br />
                    have a fantastic life. <br />
                </p>
            </div>
            <div class="footer-column">
                <h2>Follow me</h2>
                <ul class="social-media">
                    <li>
                        <a class="fa fa-youtube" href="https://www.youtube.com/channel/UCGPoHTVjMN77wcGknXPHl1Q" target="_blank" title="YouTube">
                        </a>YouTube
                    </li>
                    <li>
                        <a class="fa fa-linkedin" href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" target="_blank" title="LinkedIn">
                        </a>LinkedIn
                    </li>
                    <li>
                        <a class="fa fa-instagram" href="https://www.instagram.com/linuxchallenges/" target="_blank" title="Instagram">
                        </a>Instagram
                    </li>
                    <li>
                        <a class="fa fa-github" href="https://github.com/djeada" title="GitHub">
                        </a>Github
                    </li>
                </ul>
            </div>
        </div>
        <div>
            <p id="copyright">
                Â© Adam Djellouli. All rights reserved.
            </p>
        </div>
        <script>
            document.getElementById("copyright").innerHTML = "&copy; " + new Date().getFullYear() + " Adam Djellouli. All rights reserved.";
        </script>
        <script src="../../app.js"></script>
    </footer>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-cpp.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
jax: ["input/TeX", "output/HTML-CSS"],
extensions: ["tex2jax.js"],
"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] },
tex2jax: { inlineMath: [ ["$", "$"] ], displayMath: [ ["$$","$$"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
messageStyle: "none"
});
</script>
<script async="" id="MathJax-script" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

</html>