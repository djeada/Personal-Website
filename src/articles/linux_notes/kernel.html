<!DOCTYPE html>

<html lang="en">

<head>
    <script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5593122079896089"></script>
    <title>Understanding the Kernel</title>
    <meta charset="utf-8" />
    <meta content="Last modified: June 10, 2024" name="description" />
    <meta content="Adam Djellouli" name="keywords" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/icon.ico" rel="icon" />
    <link href="../../resources/style.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="ie-edge" http-equiv="X-UA-Compatible" />
</head>

<body>
    <nav aria-label="Main navigation">
        <a class="logo" href="https://adamdjellouli.com">
            <img alt="Adam Djellouli - Home Page Logo" id="logo-image" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/logo.PNG" />
        </a>
        <input aria-label="Toggle navigation menu" id="navbar-toggle" type="checkbox" />
        <ul role="menu">
            <li role="menuitem"> <a href="../../index.html" title="Go to Home Page"> Home </a> </li>
            <li role="menuitem"> <a class="active" href="../../core/blog.html" title="Read Adam Djellouli Blog on Programming and Technology"> Blog </a> </li>
            <li role="menuitem"> <a href="../../core/tools.html" title="Discover Tools Created by Adam Djellouli"> Tools </a> </li>
            <li role="menuitem"> <a href="../../core/projects.html" title="Explore Projects Developed by Adam Djellouli"> Projects </a> </li>
            <li role="menuitem"> <a href="../../core/resume.html" title="View Adam Djellouli Professional Resume"> Resume </a> </li>
            <button aria-label="Toggle dark mode" id="dark-mode-button"></button>
        </ul>
    </nav>
    <section id="article-body"></section>
    <div id="article-wrapper">
        <section id="article-body">
            <p style="text-align: right;"><i>Last modified: June 10, 2024</i></p>
            <p style="text-align: right;"><i>This article is written in: ðŸ‡ºðŸ‡¸</i></p>
            <h2 id="understanding-the-kernel">Understanding the Kernel</h2>
            <p>The kernel is the central part of an operating system (OS) that interfaces directly with the hardware. It acts as a bridge, mediating interactions between the software and the hardware. The kernel manages system resources, allocates memory, manages input and output requests from software, and organizes data for long-term non-volatile storage with file systems on disks. Because it operates at a low level, the kernel is protected from direct user interaction to prevent system instability or a security breach. In some cases, you can modify the kernel's behavior or capabilities by loading additional components, known as kernel modules.</p>
            <p>
            <div>
                <pre><code class="language-shell">+-------------------------------------+
|            User Space               |
| +------------------+                |
| |   Application    |                |
| +------------------+                |
|     ^       |                       |
|     |       v                       |
| +------------------+                |
| |   System Call    |                |
| +------------------+                |
|     ^       |                       |
+-------------------------------------+
|     |      Kernel Space             |
|     |       v                       |
| +------------------+                |
| | Kernel Functions |                |
| +------------------+                |
|     ^       |                       |
|     |       v                       |
| +------------------+                |
| |   Hardware Layer |                |
| +------------------+                |
+-------------------------------------+</code></pre>
            </div>
            </p>
            <h2 id="kernel-architecture">Kernel Architecture</h2>
            <p>Kernels can be designed following different architectures such as monolithic, microkernel, and hybrid. Each approach has its own benefits and trade-offs in terms of performance, security, and complexity.</p>
            <p>The Linux kernel, like the UNIX system it was inspired by, follows a monolithic architecture. Monolithic kernels encompass several responsibilities, including managing the system's Central Processing Unit (CPU), memory, Inter-Process Communication (IPC), device drivers, system calls, and file systems, all within a single kernel space. This approach makes the Linux kernel highly efficient and performant.</p>
            <h3 id="how-the-linux-kernel-differs-from-other-unix-kernels">How the Linux Kernel Differs from Other UNIX Kernels</h3>
            <ul>
                <li>
                    <p><strong>Dynamic Kernel Module Support (DKMS):</strong> Linux supports dynamic loading and unloading of modules into the kernel at runtime. This allows functionality to be added or removed without needing to reboot the system.</p>
                </li>
                <li>
                    <p><strong>Object-oriented Device Model:</strong> Linux incorporates an object-oriented device model that features device classes, hot-pluggable events, and a user-space device filesystem (devfs), allowing the system to respond to changes in hardware configurations dynamically.</p>
                </li>
                <li>
                    <p><strong>Symmetric MultiProcessing (SMP):</strong> Linux is capable of leveraging symmetric multiprocessing, which allows the OS to use multiple CPUs or cores efficiently.</p>
                </li>
                <li>
                    <p><strong>Open-source and Free:</strong> The Linux kernel, unlike many other UNIX-like operating systems, is both free and open-source. This enables a worldwide community of developers to inspect, modify, and contribute to its source code.</p>
                </li>
                <li>
                    <p><strong>Minimalistic Approach:</strong> Linux avoids incorporating features that its developers consider to be poorly designed or conceived. This approach keeps the kernel lean and efficient.</p>
                </li>
                <li>
                    <p><strong>Built-in Preemption:</strong> The Linux kernel includes built-in preemption, which allows it to interrupt and resume processes to ensure fair allocation of CPU time and improve overall system responsiveness.</p>
                </li>
                <li>
                    <p><strong>Unified Process Model:</strong> Unlike some other kernels, Linux does not distinguish between threads and regular processes in its scheduling, instead treating all as schedulable entities. This simplifies the process model and provides more uniform behavior.</p>
                </li>
            </ul>
            <h2 id="key-components-of-the-kernel">Key Components of the Kernel</h2>
            <p>The Kernel is complex and consists of several major components, each of which plays a specific role in the operating system's functionality.</p>
            <ul>
                <li>
                    <p><strong>System Call Interface (SCI):</strong> This serves as a gateway that allows applications in user space to request services from the kernel. The system call interface translates these function calls into instructions that the kernel can understand and process.</p>
                </li>
                <li>
                    <p><strong>Process Management:</strong> The kernel has the responsibility of managing all processes or threads running on the system. It handles scheduling, process synchronization, inter-process communication (IPC), and other related tasks. </p>
                </li>
                <li>
                    <p><strong>Memory Management:</strong> This component oversees the allocation and deallocation of memory for processes. It manages both physical and virtual memory, ensuring efficient use of available resources and handling page swapping to disk when physical memory is full.</p>
                </li>
                <li>
                    <p><strong>Virtual File System (VFS):</strong> The VFS abstracts the underlying details of individual file systems, providing a unified interface for user programs to interact with any supported file system.</p>
                </li>
                <li>
                    <p><strong>Network Stack:</strong> The Linux kernel includes a sophisticated networking stack that implements various networking protocols (like TCP/IP, UDP, ICMP, etc.) to enable communication over networks.</p>
                </li>
                <li>
                    <p><strong>Device Drivers:</strong> These are kernel modules that enable the kernel to interact with various hardware devices. Each device driver is specifically designed to communicate with a particular hardware component.</p>
                </li>
                <li>
                    <p><strong>Architecture-Dependent Code:</strong> This component includes specific code tailored to the hardware architecture the kernel is operating on. This code handles architecture-specific tasks and instructions.</p>
                </li>
            </ul>
            <h2 id="kernel-monitoring-and-management-tools">Kernel Monitoring and Management Tools</h2>
            <p>There are several utilities and filesystems to monitor and manage kernel operations:</p>
            <ul>
                <li>
                    <p><strong>dmesg and journalctl:</strong> You can use the <code>dmesg</code> command or <code>journalctl --dmesg</code> to view the messages output by the kernel, which are stored in a ring buffer. These messages often contain valuable information about the system's hardware and any issues the kernel encounters.</p>
                </li>
                <li>
                    <p><strong>/proc Filesystem:</strong> The <code>/proc</code> directory is a virtual filesystem that provides a window into the current state of the kernel. It contains a multitude of files and directories representing various aspects of the kernel and running processes.</p>
                </li>
                <li>
                    <p><strong>uname Command:</strong> The <code>uname</code> command provides vital information about the system, such as the kernel version and the hardware architecture. Here's a table of commonly used flags with <code>uname</code>:</p>
                </li>
            </ul>
            <p>
            <table>
                <tr>
                    <td>Flag</td>
                    <td>Description</td>
                </tr>
                <tr>
                    <td><code>-s</code></td>
                    <td>Prints the kernel name</td>
                </tr>
                <tr>
                    <td><code>-r</code></td>
                    <td>Prints the kernel release</td>
                </tr>
                <tr>
                    <td><code>-v</code></td>
                    <td>Prints the kernel version</td>
                </tr>
                <tr>
                    <td><code>-m</code></td>
                    <td>Prints the machine hardware architecture</td>
                </tr>
                <tr>
                    <td><code>-p</code></td>
                    <td>Prints the processor architecture</td>
                </tr>
            </table>
            </p>
            <p>For instance, to display all available system information, use the following command:</p>
            <p>
            <div>
                <pre><code class="language-shell">uname -a</code></pre>
            </div>
            </p>
            <h2 id="working-with-kernel-modules">Working with Kernel Modules</h2>
            <p>Kernel modules are pieces of code that can be loaded into or removed from the kernel at runtime, allowing the functionality of the kernel to be extended or modified without rebooting the system. This capability is particularly useful when dealing with hardware drivers, filesystem drivers, and system calls.</p>
            <p>Here are some commands for managing and interacting with kernel modules:</p>
            <ul>
                <li>
                    <p><code>lsmod</code>: Lists all currently loaded kernel modules. Each entry shows the module name, the amount of memory the module is using, and any modules that depend on it.</p>
                </li>
                <li>
                    <p><code>modprobe</code>: Adds or removes modules from the Linux kernel. This command handles dependencies automatically, loading any additional modules that are required.</p>
                </li>
                <li>
                    <p><code>rmmod</code>: Removes a module from the Linux kernel. Be aware that this command does not handle dependencies, so it may fail if the module is in use or if other modules depend on it.</p>
                </li>
                <li>
                    <p><code>depmod</code>: Analyzes the module dependencies in installed modules and creates a dependency file used by <code>modprobe</code> to automatically load the necessary modules.</p>
                </li>
                <li>
                    <p><code>dkms</code>: Stands for Dynamic Kernel Module Support. It's a system utility that allows you to manage kernel modules whose sources reside outside the kernel source tree. This tool helps keep track of kernel upgrades and recompiles and reinstalls modules as needed.</p>
                </li>
            </ul>
            <h2 id="dynamic-kernel-module-support-dkms-">Dynamic Kernel Module Support (DKMS)</h2>
            <p>The Dynamic Kernel Module Support (DKMS) is a program/framework that enables generating Linux kernel modules whose sources generally reside outside the kernel source tree. It helps maintain module version compatibility with different kernel versions, so you don't have to manually recompile each module every time a new kernel is installed or updated. This is particularly valuable for kernels that are updated frequently, or for distributing drivers that need to work across many different kernel versions and distributions.</p>
            <p>I. Installation</p>
            <p>To utilize DKMS, it is necessary to have the <code>dkms</code> package installed on your system.</p>
            <ul>
                <li>Installation on Debian-based systems** (like Ubuntu or Mint), you can use the following command:</li>
            </ul>
            <p>
            <div>
                <pre><code class="language-bash">sudo apt install dkms</code></pre>
            </div>
            </p>
            <ul>
                <li>Installation on Arch-based systems:</li>
            </ul>
            <p>
            <div>
                <pre><code class="language-bash">sudo pacman -S dkms</code></pre>
            </div>
            </p>
            <p>DKMS simplifies kernel module management with a set of specific commands:</p>
            <p>II. Adding a module to DKMS</p>
            <p>Before you can manage a module using DKMS, you have to add it to the DKMS tree. For instance, if the module source is in /usr/src/module-version/, use the following command:</p>
            <p>
            <div>
                <pre><code class="language-bash">dkms add -m module -v version</code></pre>
            </div>
            </p>
            <p>III. Building a module with DKMS</p>
            <p>After adding a module, you can build it using DKMS. It's a necessary step before installation:</p>
            <p>
            <div>
                <pre><code class="language-bash">dkms build -m module -v version</code></pre>
            </div>
            </p>
            <p>III. Installing a module with DKMS</p>
            <p>After the module is built, you can install it to your system:</p>
            <p>
            <div>
                <pre><code class="language-bash">dkms install -m module -v version</code></pre>
            </div>
            </p>
            <p>IV. Removing a module from DKMS</p>
            <p>If you no longer need a module or want to install a different version, you can remove the module from the DKMS tree and uninstall it from your system:</p>
            <p>
            <div>
                <pre><code class="language-bash">dkms remove -m module -v version --all</code></pre>
            </div>
            </p>
            <p>V. Checking the status of modules</p>
            <p>You can also use DKMS to check the status of all modules that it's currently managing:</p>
            <p>
            <div>
                <pre><code class="language-bash">dkms status</code></pre>
            </div>
            </p>
            <h2 id="challenges">Challenges</h2>
            <ol>
                <li>Download the latest Linux kernel source code from the official repository. Configure and compile it for a specific system. Document the steps and choices made during configuration.</li>
                <li>Develop a simple kernel module, such as a 'Hello World' module. Load and unload it from your Linux kernel, and inspect the system log to verify its functioning.</li>
                <li>Tune a Linux kernel for enhanced performance on a specific hardware setup. Modify parameters such as scheduler settings, file system support, and networking options. Benchmark the system before and after the optimization.</li>
                <li>Find on the internet a kernel patch (for a bug fix or improvement) and apply it to your kernel source. Re-compile and test the kernel to ensure the patch functions as expected.</li>
                <li>Simulate a kernel panic using tools or commands (like <code>sysrq</code> trigger). Capture and analyze the output to understand the cause of the panic and how to recover from such situations.</li>
                <li>Create a custom kernel configuration for a specific use case, like a gaming system, server, or embedded device. Tailor features and modules for the chosen application, and explain your configuration choices.</li>
                <li>Write a script to automate the deployment of a newly compiled kernel, including copying it to the <code>/boot</code> directory, updating the boot loader configuration, and rebooting the system.</li>
                <li>Use the <code>git bisect</code> tool to identify a regression in the kernel. Document the process of finding the offending commit in the kernel source.</li>
                <li>Configure and compile a real-time Linux kernel. Test its real-time capabilities with appropriate benchmarks or tools, and discuss the implications and challenges of using a real-time kernel.</li>
                <li>Explore kernel security modules like SELinux or AppArmor. Set up a module, create custom security policies, and test their effectiveness in enhancing system security.</li>
            </ol>
        </section>
        <div id="table-of-contents">
            <h2>Table of Contents</h2>
            <ol>
                <li><a href="#understanding-the-kernel">Understanding the Kernel</a></li>
                <li><a href="#kernel-architecture">Kernel Architecture</a>
                    <ol>
                        <li><a href="#how-the-linux-kernel-differs-from-other-unix-kernels">How the Linux Kernel Differs from Other UNIX Kernels</a></li>
                    </ol>
                </li>
                <li><a href="#key-components-of-the-kernel">Key Components of the Kernel</a></li>
                <li><a href="#kernel-monitoring-and-management-tools">Kernel Monitoring and Management Tools</a></li>
                <li><a href="#working-with-kernel-modules">Working with Kernel Modules</a></li>
                <li><a href="#dynamic-kernel-module-support-dkms-">Dynamic Kernel Module Support (DKMS)</a></li>
                <li><a href="#challenges">Challenges</a></li>
            </ol>
            <div id="related-articles">
                <h2>Related Articles</h2>
                <ol>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/commands.html">Commands</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/cron_jobs.html">Cron Jobs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/disk_usage.html">Disk Usage</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/dwm.html">Dwm</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/encryption.html">Encryption</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/enviroment_modules.html">Enviroment Modules</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/enviroment_variable.html">Enviroment Variable</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/file_system.html">File System</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/files_and_dirs.html">Files and Dirs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/finding_files.html">Finding Files</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/firewall.html">Firewall</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/grep.html">Grep</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/hardware.html">Hardware</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/inodes_and_symlinks.html">Inodes and Symlinks</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/introduction.html">Introduction</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/kernel.html">Kernel</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ldap.html">Ldap</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/log_files_and_journals.html">Log Files and Journals</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/logical_volume_management.html">Logical Volume Management</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/managing_users.html">Managing Users</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/mounting.html">Mounting</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/networking.html">Networking</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/nfs.html">Nfs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/package_managers.html">Package Managers</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/partitions.html">Partitions</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/performance_monitoring.html">Performance Monitoring</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/permissions.html">Permissions</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/pipe_and_redirect.html">Pipe and Redirect</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ports.html">Ports</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/processes.html">Processes</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/sed_and_awk.html">Sed and Awk</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/selinux.html">Selinux</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/services.html">Services</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/shells_and_bash_configuration.html">Shells and Bash Configuration</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ssh_and_scp.html">Ssh and Scp</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/system_startup.html">System Startup</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/tar_and_gzip.html">Tar and Gzip</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/utilities.html">Utilities</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/virtual_machines.html">Virtual Machines</a></li>
                </ol>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer-columns">
            <div class="footer-column">
                <img alt="Adam Djellouli Symbol" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/symbol.png" />
            </div>
            <div class="footer-column">
                <h2><a href="https://adamdjellouli.com/core/privacy_policy.html" title="Privacy Policy">Our Privacy Policy</a></h2>
                <p>
                    Thank you for visiting my personal website. All of the <br />
                    content on this site is free to use, but please remember <br />
                    to be a good human being and refrain from any abuse<br />
                    of the site. If you would like to contact me, please use <br />
                    my <a href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" title="LinkedIn Profile">LinkedIn profile</a> or my <a href="https://github.com/djeada" title="GitHub Profile">GitHub</a> if you have any technical <br />
                    issues or ideas to share. I wish you the best and hope you <br />
                    have a fantastic life. <br />
                </p>
            </div>
            <div class="footer-column">
                <h2>Follow me</h2>
                <ul class="social-media">
                    <li>
                        <a class="fa fa-youtube" href="https://www.youtube.com/channel/UCGPoHTVjMN77wcGknXPHl1Q" target="_blank" title="YouTube">
                        </a>YouTube
                    </li>
                    <li>
                        <a class="fa fa-linkedin" href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" target="_blank" title="LinkedIn">
                        </a>LinkedIn
                    </li>
                    <li>
                        <a class="fa fa-instagram" href="https://www.instagram.com/linuxchallenges/" target="_blank" title="Instagram">
                        </a>Instagram
                    </li>
                    <li>
                        <a class="fa fa-github" href="https://github.com/djeada" title="GitHub">
                        </a>Github
                    </li>
                </ul>
            </div>
        </div>
        <div>
            <p id="copyright">
                Â© Adam Djellouli. All rights reserved.
            </p>
        </div>
        <script>
            document.getElementById("copyright").innerHTML = "&copy; " + new Date().getFullYear() + " Adam Djellouli. All rights reserved.";
        </script>
        <script src="../../app.js"></script>
    </footer>
</body>

</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-cpp.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
jax: ["input/TeX", "output/HTML-CSS"],
extensions: ["tex2jax.js"],
"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] },
tex2jax: { inlineMath: [ ["$", "$"] ], displayMath: [ ["$$","$$"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
messageStyle: "none"
});
</script>
<script async="" id="MathJax-script" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>