<!DOCTYPE html>

<html lang="en">

<head>
    <script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5593122079896089"></script>
    <meta charset="utf-8" />
    <title>SELinux</title>
    <meta content="Security-Enhanced Linux (SELinux) is a robust security module integrated into the Linux kernel that provides a mechanism for supporting access control security policies." name="description" />
    <meta content="Adam Djellouli" name="author" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <link crossorigin="" href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/icon.ico" rel="icon" />
    <link href="../../resources/style.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
</head>

<body>
    <nav aria-label="Main navigation">
        <a class="logo" href="https://adamdjellouli.com">
            <img alt="Adam Djellouli - Home Page Logo" id="logo-image" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/logo.PNG" />
        </a>
        <input aria-label="Toggle navigation menu" id="navbar-toggle" type="checkbox" />
        <ul aria-labelledby="navbar-toggle" role="menu">
            <li role="menuitem">
                <a href="../../index.html" title="Go to Home Page"> Home </a>
            </li>
            <li role="menuitem">
                <a class="active" href="../../core/blog.html" title="Read Adam Djellouli Blog on Programming and Technology"> Blog </a>
            </li>
            <li role="menuitem">
                <a href="../../core/tools.html" title="Discover Tools Created by Adam Djellouli"> Tools </a>
            </li>
            <li role="menuitem">
                <a href="../../core/projects.html" title="Explore Projects Developed by Adam Djellouli"> Projects </a>
            </li>
            <li role="menuitem">
                <a href="../../core/resume.html" title="View Adam Djellouli Professional Resume"> Resume </a>
            </li>
            <li>
                <script async="" src="https://cse.google.com/cse.js?cx=8160ef9bb935f4f68"></script>
                <div class="gcse-search"></div>
            </li>
            <li>
                <button aria-label="Toggle dark mode" id="dark-mode-button"></button>
            </li>
        </ul>
    </nav>
    <div id="article-wrapper">
        <section id="article-body">
            <p style="text-align: right;"><i>Last modified: October 10, 2024</i></p>
            <p style="text-align: right;"><i>This article is written in: ðŸ‡ºðŸ‡¸</i></p>
            <h2 id="selinux">SELinux</h2>
            <p>Security-Enhanced Linux (SELinux) is a robust security module integrated into the Linux kernel that provides a mechanism for supporting access control security policies. Unlike traditional discretionary access control (DAC) systems where users have control over their own files and processes, SELinux implements mandatory access control (MAC), ensuring that the system enforces security policies regardless of user actions. </p>
            <p>SELinux works by assigning labels, or security contexts, to all processes and objects (like files and sockets) on the system. These contexts are then used to make decisions about whether a process can access a resource. By enforcing least privilege, SELinux confines user programs and system services to the minimum required permissions, greatly reducing the potential damage from malicious or misconfigured software.</p>
            <p>Developed by the United States National Security Agency (NSA) and released to the open-source community, SELinux has become a cornerstone of Linux security, particularly in environments where security is paramount, such as servers handling sensitive data or systems exposed to the internet.</p>
            <h3 id="overview-of-selinux-architecture">Overview of SELinux Architecture</h3>
            <p>Understanding the architecture of SELinux is key to leveraging its full potential. SELinux operates within the kernel and works alongside existing Linux security mechanisms to enforce its policies.</p>
            <h4 id="architecture-diagram">Architecture Diagram</h4>
            <p>
            <div>
                <pre><code class="language-shell">+---------------------------------------------------+
|                   User Process                    |
|             (e.g., Web Server, SSH Daemon)        |
+----------------------+----------------------------+
                           |
                           | 1. Access Request (Read/Write)
                           v
+----------------------+----------------------------+
|               SELinux Security Server             |
|          (Policy Decision Point - PDP)            |
+----------------------+----------------------------+
                           |
                           | 2. Policy Decision (Allow/Deny)
                           v
+----------------------+----------------------------+
|          SELinux Object Manager and AVC           |
|          (Policy Enforcement Point - PEP)         |
+----------------------+----------------------------+
                           |
                           | 3. Enforce Decision
                           v
+----------------------+----------------------------+
|                    Linux Kernel                   |
|             (Executes Allowed Operations)         |
+---------------------------------------------------+</code></pre>
            </div>
            </p>
            <h4 id="detailed-explanation">Detailed Explanation</h4>
            <p>I. User Process (Subject):</p>
            <ul>
                <li>Any running application or service, such as a web server (<code>httpd</code>), an SSH daemon (<code>sshd</code>), or a user application.</li>
                <li>The process attempts to perform an action, like reading a file, writing to a socket, or executing a program.</li>
                <li>This action is considered an access request to an object (resource).</li>
            </ul>
            <p>II. SELinux Security Server (Policy Decision Point - PDP):</p>
            <ul>
                <li>Intercepts the access request and consults the loaded SELinux policies.</li>
                <li>Determines whether the requested action is permitted based on the security contexts of the subject and object.</li>
                <li>Allow or Deny.</li>
            </ul>
            <p>III. SELinux Object Manager and Access Vector Cache (AVC) (Policy Enforcement Point - PEP):</p>
            <ul>
                <li>Enforces the policy decision by either permitting or denying the action.</li>
                <li>Caches previous decisions to optimize performance, reducing the overhead of policy checks.</li>
            </ul>
            <p>IV. Linux Kernel:</p>
            <ul>
                <li>If the action is allowed, the kernel proceeds to execute the operation.</li>
                <li>If denied, the kernel blocks the operation and logs the denial.</li>
            </ul>
            <h3 id="selinux-modes-of-operation">SELinux Modes of Operation</h3>
            <p>SELinux can operate in different modes, allowing administrators to balance security enforcement with system usability.</p>
            <p>
            <table>
                <tr>
                    <td><strong>Mode</strong></td>
                    <td><strong>Description</strong></td>
                    <td><strong>Behavior</strong></td>
                    <td><strong>Use Cases</strong></td>
                </tr>
                <tr>
                    <td><strong>Enforcing Mode</strong></td>
                    <td>SELinux policies are actively enforced. Unauthorized access attempts are blocked, and denials are logged.</td>
                    <td>- Denied actions are prevented from occurring. <br /> - Denials are logged to audit logs.</td>
                    <td>- Production environments where security is critical. <br /> - Systems that have been properly configured.</td>
                </tr>
                <tr>
                    <td><strong>Permissive Mode</strong></td>
                    <td>SELinux policies are not enforced, but violations are logged. Allows all actions but records denials.</td>
                    <td>- Actions that violate policies are allowed. <br /> - Denials are logged for troubleshooting.</td>
                    <td>- Debugging and policy development. <br /> - Temporarily used when adjusting system configurations.</td>
                </tr>
                <tr>
                    <td><strong>Disabled Mode</strong></td>
                    <td>SELinux is completely turned off. No policies are loaded or enforced, and no logging occurs.</td>
                    <td>- All SELinux functions are disabled. <br /> - System relies on traditional UNIX permissions.</td>
                    <td>- Not recommended due to security risks. <br /> - May be used where SELinux compatibility is an issue.</td>
                </tr>
            </table>
            </p>
            <h4 id="mode-comparison-table">Mode Comparison Table</h4>
            <p>
            <div>
                <pre><code class="language-shell">+------------------+------------------+------------------+
|  Enforcing Mode  | Permissive Mode  |  Disabled Mode   |
+------------------+------------------+------------------+
| Policies Enforced| Policies Not     | Policies Not     |
|                  | Enforced         | Loaded           |
| Denials Blocked  | Denials Logged   | No SELinux       |
| and Logged       |                  | Functionality    |
+------------------+------------------+------------------+</code></pre>
            </div>
            </p>
            <p><strong>Note:</strong> Switching between modes can impact system security and functionality. Always ensure that mode changes are intentional and understood.</p>
            <h3 id="selinux-policy-types">SELinux Policy Types</h3>
            <p>SELinux policies define the rules that govern how processes and resources interact. There are two main policy types:</p>
            <p>
            <table>
                <tr>
                    <td><strong>Policy</strong></td>
                    <td><strong>Description</strong></td>
                    <td><strong>Behavior</strong></td>
                    <td><strong>Use Cases</strong></td>
                </tr>
                <tr>
                    <td><strong>Strict Policy</strong></td>
                    <td>Applies SELinux rules to all processes, including user-level and system processes, enforcing security on all aspects.</td>
                    <td>- Enforces security policies on all processes, whether system or user. <br /> - More comprehensive and restrictive.</td>
                    <td>- High-security environments where every process needs to be secured. <br /> - Systems requiring detailed security control.</td>
                </tr>
                <tr>
                    <td><strong>Targeted Policy</strong></td>
                    <td>Applies SELinux rules only to specific targeted processes (e.g., system services), while other processes run unconfined.</td>
                    <td>- Only critical system services are restricted by SELinux. <br /> - Non-targeted processes run without SELinux restrictions.</td>
                    <td>- Default policy in many Linux distributions. <br /> - Systems where a balance between security and ease of use is needed.</td>
                </tr>
            </table>
            </p>
            <ul>
                <li><strong>Targeted Policy</strong> is recommended for most users due to its balance between security and usability.</li>
                <li><strong>Strict Policy</strong> offers more security but requires extensive configuration and may impact system functionality.</li>
            </ul>
            <h3 id="selinux-contexts-and-labels">SELinux Contexts and Labels</h3>
            <p>SELinux uses security contexts (also known as labels) to make decisions about access control. Every object and process in the system has a context consisting of:</p>
            <p>
            <table>
                <tr>
                    <td><strong>Component</strong></td>
                    <td><strong>Description</strong></td>
                    <td><strong>Details</strong></td>
                </tr>
                <tr>
                    <td><strong>User Identity</strong></td>
                    <td>Represents the SELinux user, which may differ from the UNIX user.</td>
                    <td>- Controls the roles a user can assume.</td>
                </tr>
                <tr>
                    <td><strong>Role</strong></td>
                    <td>Defines what domains a user or process can enter.</td>
                    <td>- Common roles include <code>system_r</code> for system processes and <code>object_r</code> for objects.</td>
                </tr>
                <tr>
                    <td><strong>Type (Domain)</strong></td>
                    <td>The most critical part for access control.</td>
                    <td>- Types are assigned to objects, and domains are types assigned to processes. <br /> - Policies define domain access to types.</td>
                </tr>
                <tr>
                    <td><strong>Level</strong></td>
                    <td>Used in Multi-Level Security (MLS) and Multi-Category Security (MCS).</td>
                    <td>- Defines the sensitivity and categories for the context.</td>
                </tr>
            </table>
            </p>
            <h4 id="example-context">Example Context</h4>
            <p>
            <div>
                <pre><code class="language-shell">system_u:object_r:httpd_sys_content_t:s0</code></pre>
            </div>
            </p>
            <ul>
                <li><strong>system_u</strong>: SELinux user identity.</li>
                <li><strong>object_r</strong>: Role indicating it's an object.</li>
                <li><strong>httpd_sys_content_t</strong>: Type for HTTP server content.</li>
                <li><strong>s0</strong>: Sensitivity level.</li>
            </ul>
            <p><strong>Importance of Correct Labeling:</strong>
                Incorrect contexts can cause SELinux to deny access to resources, even if UNIX permissions allow it. Proper labeling ensures that policies are enforced as intended.</p>
            <h3 id="managing-selinux-modes">Managing SELinux Modes</h3>
            <h4 id="checking-the-current-mode">Checking the Current Mode</h4>
            <p>Use <code>getenforce</code> to check the current SELinux mode:</p>
            <p>
            <div>
                <pre><code class="language-bash">getenforce</code></pre>
            </div>
            </p>
            <p><strong>Possible Outputs:</strong></p>
            <ul>
                <li><code>Enforcing</code></li>
                <li><code>Permissive</code></li>
                <li><code>Disabled</code></li>
            </ul>
            <p><strong>Example:</strong></p>
            <p>
            <div>
                <pre><code class="language-bash">$ getenforce
Enforcing</code></pre>
            </div>
            </p>
            <h4 id="temporarily-changing-the-mode">Temporarily Changing the Mode</h4>
            <p>To temporarily switch between enforcing and permissive modes:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo setenforce [Enforcing|Permissive|1|0]</code></pre>
            </div>
            </p>
            <ul>
                <li><strong>Enforcing or 1</strong>: Enables enforcing mode.</li>
                <li><strong>Permissive or 0</strong>: Enables permissive mode.</li>
            </ul>
            <p><strong>Example:</strong></p>
            <p>
            <div>
                <pre><code class="language-bash">sudo setenforce 0   # Switch to permissive mode</code></pre>
            </div>
            </p>
            <p><strong>Verification:</strong></p>
            <p>
            <div>
                <pre><code class="language-bash">getenforce</code></pre>
            </div>
            </p>
            <h4 id="permanently-changing-the-mode">Permanently Changing the Mode</h4>
            <p>Edit the SELinux configuration file <code>/etc/selinux/config</code>:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo nano /etc/selinux/config</code></pre>
            </div>
            </p>
            <p>Change the line:</p>
            <p>
            <div>
                <pre><code class="language-bash">SELINUX=enforcing</code></pre>
            </div>
            </p>
            <p>Options:</p>
            <ul>
                <li><code>enforcing</code></li>
                <li><code>permissive</code></li>
                <li><code>disabled</code></li>
            </ul>
            <p><strong>Note:</strong> Reboot the system to apply changes.</p>
            <p><strong>Example:</strong></p>
            <p>
            <div>
                <pre><code class="language-bash">SELINUX=permissive</code></pre>
            </div>
            </p>
            <h3 id="working-with-selinux-contexts">Working with SELinux Contexts</h3>
            <h4 id="viewing-contexts">Viewing Contexts</h4>
            <p>List files with their SELinux contexts:</p>
            <p>
            <div>
                <pre><code class="language-bash">ls -Z /path/to/file</code></pre>
            </div>
            </p>
            <p><strong>Sample Output:</strong></p>
            <p>
            <div>
                <pre><code class="language-shell">-rw-r--r--. root root system_u:object_r:etc_t:s0 /etc/passwd</code></pre>
            </div>
            </p>
            <p>List processes with their contexts:</p>
            <p>
            <div>
                <pre><code class="language-bash">ps -eZ | grep sshd</code></pre>
            </div>
            </p>
            <p><strong>Sample Output:</strong></p>
            <p>
            <div>
                <pre><code class="language-shell">system_u:system_r:sshd_t:s0-s0:c0.c1023  1234 ? 00:00:00 sshd</code></pre>
            </div>
            </p>
            <h4 id="using-chcon">Using <code>chcon</code></h4>
            <p>Change the type of a file:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo chcon -t httpd_sys_content_t /var/www/html/index.html</code></pre>
            </div>
            </p>
            <p><strong>Explanation:</strong></p>
            <ul>
                <li><code>-t</code>: Specifies the new type.</li>
                <li>Changes are immediate but not persistent across relabels.</li>
            </ul>
            <h4 id="restoring-default-contexts">Restoring Default Contexts</h4>
            <p>Use <code>restorecon</code> to reset contexts to their default values:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo restorecon -Rv /var/www/html/</code></pre>
            </div>
            </p>
            <ul>
                <li><code>-R</code>: Recursively apply to all files in the directory.</li>
                <li><code>-v</code>: Verbose output.</li>
            </ul>
            <h4 id="using-semanage-fcontext-for-persistent-changes">Using <code>semanage fcontext</code> for Persistent Changes</h4>
            <p>Add a context mapping:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo semanage fcontext -a -t httpd_sys_content_t "/srv/mywebsite(/.*)?"</code></pre>
            </div>
            </p>
            <p>Apply the context:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo restorecon -Rv /srv/mywebsite/</code></pre>
            </div>
            </p>
            <p><strong>Explanation:</strong></p>
            <ul>
                <li><code>semanage fcontext</code> adds a persistent mapping.</li>
                <li><code>restorecon</code> applies the mapping to existing files.</li>
            </ul>
            <h3 id="selinux-booleans">SELinux Booleans</h3>
            <p>Booleans allow administrators to modify SELinux policy behavior without writing new policies.</p>
            <h4 id="listing-booleans">Listing Booleans</h4>
            <p>List all Booleans and their statuses:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo getsebool -a</code></pre>
            </div>
            </p>
            <p><strong>Filter Booleans:</strong></p>
            <p>
            <div>
                <pre><code class="language-bash">sudo getsebool -a | grep httpd</code></pre>
            </div>
            </p>
            <h4 id="temporarily-changing-a-boolean">Temporarily Changing a Boolean</h4>
            <p>
            <div>
                <pre><code class="language-bash">sudo setsebool httpd_enable_cgi on</code></pre>
            </div>
            </p>
            <h4 id="permanently-changing-a-boolean">Permanently Changing a Boolean</h4>
            <p>
            <div>
                <pre><code class="language-bash">sudo setsebool -P httpd_enable_cgi on</code></pre>
            </div>
            </p>
            <ul>
                <li><code>-P</code> makes the change persistent across reboots.</li>
            </ul>
            <p><strong>Common Booleans:</strong></p>
            <ul>
                <li><code>httpd_can_network_connect</code>: Allows HTTPD scripts and modules to connect to the network.</li>
                <li><code>ftp_home_dir</code>: Allows FTP to read and write files in user home directories.</li>
            </ul>
            <h3 id="selinux-troubleshooting">SELinux Troubleshooting</h3>
            <h4 id="audit-log">Audit Log</h4>
            <ul>
                <li><strong>Location</strong>: <code>/var/log/audit/audit.log</code></li>
                <li><strong>Contains</strong>: Detailed records of all SELinux denials and other security events.</li>
            </ul>
            <h4 id="access-vector-cache-avc-messages">Access Vector Cache (AVC) Messages</h4>
            <ul>
                <li><strong>Contain</strong>: Denied access attempts.</li>
                <li><strong>Example Entry:</strong></li>
            </ul>
            <p>
            <div>
                <pre><code class="language-shell">type=AVC msg=audit(1609459200.123:456): avc:  denied  { read } for  pid=1234 comm="nginx" name="index.html" dev="sda1" ino=56789 scontext=system_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:default_t:s0 tclass=file</code></pre>
            </div>
            </p>
            <h4 id="ausearch"><code>ausearch</code></h4>
            <p>Search for AVC denials:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo ausearch -m avc -ts today</code></pre>
            </div>
            </p>
            <ul>
                <li><code>-m avc</code>: Search for AVC messages.</li>
                <li><code>-ts today</code>: Start time of today.</li>
            </ul>
            <h4 id="sealert"><code>sealert</code></h4>
            <p>Analyzes SELinux denials and provides recommendations:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo sealert -a /var/log/audit/audit.log</code></pre>
            </div>
            </p>
            <p>Requires the <code>setroubleshoot</code> package.</p>
            <h4 id="common-troubleshooting-steps">Common Troubleshooting Steps</h4>
            <p>I. Identify Denials</p>
            <p>Use <code>ausearch</code> or check <code>/var/log/audit/audit.log</code> for recent denials.</p>
            <p>II. Understand Denials</p>
            <p>Use <code>sealert</code> or <code>audit2why</code> to get explanations.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo cat /var/log/audit/audit.log | audit2why</code></pre>
            </div>
            </p>
            <p>III. Adjust Contexts</p>
            <p>Ensure files and directories have correct contexts.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo restorecon -Rv /path/to/directory</code></pre>
            </div>
            </p>
            <p>IV. Modify Booleans</p>
            <p>Enable relevant Booleans if necessary.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo setsebool -P httpd_can_network_connect on</code></pre>
            </div>
            </p>
            <p>V. Create Custom Policies</p>
            <p>As a last resort, use <code>audit2allow</code> to generate custom policies.</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo grep nginx /var/log/audit/audit.log | audit2allow -M nginx_custom
sudo semodule -i nginx_custom.pp</code></pre>
            </div>
            </p>
            <p><strong>Caution:</strong> Review custom policies carefully to avoid security risks.</p>
            <h3 id="practical-example-allowing-nginx-to-serve-content-from-a-custom-directory">Practical Example: Allowing Nginx to Serve Content from a Custom Directory</h3>
            <p>You have Nginx installed and want it to serve content from <code>/srv/mywebsite/</code>. However, accessing the site results in a 403 Forbidden error, and SELinux is suspected to be the cause.</p>
            <h4 id="1-verify-selinux-denials">1. Verify SELinux Denials</h4>
            <p>Check for AVC denials related to Nginx:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo ausearch -m avc -c nginx</code></pre>
            </div>
            </p>
            <p><strong>Sample Output:</strong></p>
            <p>
            <div>
                <pre><code class="language-shell">type=AVC msg=audit(1609459200.123:456): avc:  denied  { open } for  pid=1234 comm="nginx" path="/srv/mywebsite/index.html" dev="sda1" ino=56789 scontext=system_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:default_t:s0 tclass=file</code></pre>
            </div>
            </p>
            <h4 id="2-assign-the-correct-context">2. Assign the Correct Context</h4>
            <p>Define the context mapping:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo semanage fcontext -a -t httpd_sys_content_t "/srv/mywebsite(/.*)?"</code></pre>
            </div>
            </p>
            <p>Apply the context:</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo restorecon -Rv /srv/mywebsite/</code></pre>
            </div>
            </p>
            <h4 id="3-verify-the-context">3. Verify the Context</h4>
            <p>
            <div>
                <pre><code class="language-bash">ls -Z /srv/mywebsite/</code></pre>
            </div>
            </p>
            <p><strong>Sample Output:</strong></p>
            <p>
            <div>
                <pre><code class="language-shell">-rw-r--r--. root root unconfined_u:object_r:httpd_sys_content_t:s0 index.html</code></pre>
            </div>
            </p>
            <h4 id="4-check-for-remaining-denials">4. Check for Remaining Denials</h4>
            <p>
            <div>
                <pre><code class="language-bash">sudo ausearch -m avc -c nginx</code></pre>
            </div>
            </p>
            <ul>
                <li>If no denials are found, the issue is resolved.</li>
            </ul>
            <h4 id="5-adjust-booleans-if-necessary">5. Adjust Booleans if Necessary</h4>
            <p>If Nginx requires additional permissions (e.g., connecting to the network):</p>
            <p>
            <div>
                <pre><code class="language-bash">sudo setsebool -P httpd_can_network_connect on</code></pre>
            </div>
            </p>
            <h3 id="challenges">Challenges</h3>
            <ol>
                <li>Research and compare Discretionary Access Control (DAC) and Mandatory Access Control (MAC). Create a document explaining how each is implemented in Linux, with a specific focus on SELinux as an example of MAC. Describe how DAC and MAC contribute to system security, and provide examples of when each control method is applied.</li>
                <li>Write a short guide on the three SELinux modes: Enforcing, Permissive, and Disabled. For each mode, include scenarios or use cases where it is most suitable, and explain the benefits and potential risks associated with using each mode. Discuss the implications of switching modes on system security and stability.</li>
                <li>Create a file and directory on a Linux system with SELinux enabled, then change their SELinux contexts using both <code>chcon</code> and <code>semanage fcontext</code> commands. Document the process and explain the differences between temporary and persistent changes to SELinux contexts. Discuss scenarios where modifying the SELinux context is essential, such as configuring web server directories.</li>
                <li>Simulate a common SELinux issue, like a service being denied access to a directory, and troubleshoot the problem using <code>/var/log/audit/audit.log</code> and <code>sealert</code>. Document your troubleshooting steps, including identifying the source of the issue and suggesting a solution. Reflect on how SELinux logs provide valuable insight into system security.</li>
                <li>Devise a scenario where a Linux server, such as a web server, is exposed to the internet and at risk of unauthorized access. Create an outline for an SELinux policy that could mitigate these risks. Describe the types of rules and policies you would enforce, and explain how they improve security by restricting services and limiting access to critical files.</li>
                <li>On a test Linux system, switch between the different SELinux modesâ€”Enforcing, Permissive, and Disabledâ€”and observe the systemâ€™s behavior and the logs generated in each mode. Document how each mode impacts system security and performance, and discuss why Enforcing mode is recommended for production environments.</li>
                <li>Write a basic custom SELinux policy module for a specific application, such as a web server or a custom application. Compile and apply the policy on your Linux system, then test the application to ensure it functions as expected. Document any issues encountered and explain how the policy enhances the security of the application.</li>
                <li>Analyze audit logs from an SELinux-enabled system and identify policy violations or security anomalies. Propose adjustments to existing SELinux policies or system configurations to resolve these issues, such as refining rules or modifying SELinux booleans. Explain how these changes would prevent similar issues in the future.</li>
                <li>List and describe common SELinux file types and contexts, such as <code>httpd_sys_content_t</code> and <code>user_home_t</code>. Create a few files with different contexts and discuss the importance of correctly assigning file contexts based on their intended use. Explain how improper contexts can impact system functionality and security.</li>
                <li>Research the <code>semanage boolean</code> command and list several SELinux booleans commonly used to configure services like HTTP and FTP. Enable and disable specific booleans related to web server security, such as allowing access to the home directory, and observe how they affect system behavior. Document your findings and explain the significance of SELinux booleans for managing service permissions.</li>
            </ol>
        </section>
        <div id="table-of-contents">
            <h2>Table of Contents</h2>
            <ol><a href="#selinux">SELinux</a>
                <ol>
                    <li><a href="#overview-of-selinux-architecture">Overview of SELinux Architecture</a>
                        <ol>
                            <li><a href="#architecture-diagram">Architecture Diagram</a></li>
                            <li><a href="#detailed-explanation">Detailed Explanation</a></li>
                        </ol>
                    </li>
                    <li><a href="#selinux-modes-of-operation">SELinux Modes of Operation</a>
                        <ol>
                            <li><a href="#mode-comparison-table">Mode Comparison Table</a></li>
                        </ol>
                    </li>
                    <li><a href="#selinux-policy-types">SELinux Policy Types</a></li>
                    <li><a href="#selinux-contexts-and-labels">SELinux Contexts and Labels</a>
                        <ol>
                            <li><a href="#example-context">Example Context</a></li>
                        </ol>
                    </li>
                    <li><a href="#managing-selinux-modes">Managing SELinux Modes</a>
                        <ol>
                            <li><a href="#checking-the-current-mode">Checking the Current Mode</a></li>
                            <li><a href="#temporarily-changing-the-mode">Temporarily Changing the Mode</a></li>
                            <li><a href="#permanently-changing-the-mode">Permanently Changing the Mode</a></li>
                        </ol>
                    </li>
                    <li><a href="#working-with-selinux-contexts">Working with SELinux Contexts</a>
                        <ol>
                            <li><a href="#viewing-contexts">Viewing Contexts</a></li>
                            <li><a href="#using-chcon">Using chcon</a></li>
                            <li><a href="#restoring-default-contexts">Restoring Default Contexts</a></li>
                            <li><a href="#using-semanage-fcontext-for-persistent-changes">Using semanage fcontext for Persistent Changes</a></li>
                        </ol>
                    </li>
                    <li><a href="#selinux-booleans">SELinux Booleans</a>
                        <ol>
                            <li><a href="#listing-booleans">Listing Booleans</a></li>
                            <li><a href="#temporarily-changing-a-boolean">Temporarily Changing a Boolean</a></li>
                            <li><a href="#permanently-changing-a-boolean">Permanently Changing a Boolean</a></li>
                        </ol>
                    </li>
                    <li><a href="#selinux-troubleshooting">SELinux Troubleshooting</a>
                        <ol>
                            <li><a href="#audit-log">Audit Log</a></li>
                            <li><a href="#access-vector-cache-avc-messages">Access Vector Cache (AVC) Messages</a></li>
                            <li><a href="#ausearch">ausearch</a></li>
                            <li><a href="#sealert">sealert</a></li>
                            <li><a href="#common-troubleshooting-steps">Common Troubleshooting Steps</a></li>
                        </ol>
                    </li>
                    <li><a href="#practical-example-allowing-nginx-to-serve-content-from-a-custom-directory">Practical Example: Allowing Nginx to Serve Content from a Custom Directory</a>
                        <ol>
                            <li><a href="#1-verify-selinux-denials">1. Verify SELinux Denials</a></li>
                            <li><a href="#2-assign-the-correct-context">2. Assign the Correct Context</a></li>
                            <li><a href="#3-verify-the-context">3. Verify the Context</a></li>
                            <li><a href="#4-check-for-remaining-denials">4. Check for Remaining Denials</a></li>
                            <li><a href="#5-adjust-booleans-if-necessary">5. Adjust Booleans if Necessary</a></li>
                        </ol>
                    </li>
                    <li><a href="#challenges">Challenges</a></li>
                </ol>
            </ol>
            <div id="related-articles">
                <h2>Related Articles</h2>
                <ol>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/commands.html">Commands</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/cron_jobs.html">Cron Jobs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/disk_usage.html">Disk Usage</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/dwm.html">Dwm</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/encryption.html">Encryption</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/enviroment_modules.html">Enviroment Modules</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/enviroment_variable.html">Enviroment Variable</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/file_system.html">File System</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/files_and_dirs.html">Files and Dirs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/finding_files.html">Finding Files</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/firewall.html">Firewall</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/grep.html">Grep</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/hardware.html">Hardware</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/inodes_and_symlinks.html">Inodes and Symlinks</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/introduction.html">Introduction</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/kernel.html">Kernel</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ldap.html">Ldap</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/log_files_and_journals.html">Log Files and Journals</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/logical_volume_management.html">Logical Volume Management</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/managing_users.html">Managing Users</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/mounting.html">Mounting</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/networking.html">Networking</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/nfs.html">Nfs</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/package_managers.html">Package Managers</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/partitions.html">Partitions</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/performance_monitoring.html">Performance Monitoring</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/permissions.html">Permissions</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/pipe_and_redirect.html">Pipe and Redirect</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ports.html">Ports</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/processes.html">Processes</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/sed_and_awk.html">Sed and Awk</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/selinux.html">Selinux</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/services.html">Services</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/shells_and_bash_configuration.html">Shells and Bash Configuration</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/ssh_and_scp.html">Ssh and Scp</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/system_startup.html">System Startup</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/tar_and_gzip.html">Tar and Gzip</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/utilities.html">Utilities</a></li>
                    <li><a href="https://adamdjellouli.com/articles/linux_notes/virtual_machines.html">Virtual Machines</a></li>
                </ol>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer-columns">
            <div class="footer-column">
                <img alt="Adam Djellouli Symbol" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/symbol.png" />
            </div>
            <div class="footer-column">
                <h2><a href="https://adamdjellouli.com/core/privacy_policy.html" title="Privacy Policy">Our Privacy Policy</a></h2>
                <p>
                    Thank you for visiting my personal website. All of the <br />
                    content on this site is free to use, but please remember <br />
                    to be a good human being and refrain from any abuse<br />
                    of the site. If you would like to contact me, please use <br />
                    my <a href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" title="LinkedIn Profile">LinkedIn profile</a> or my <a href="https://github.com/djeada" title="GitHub Profile">GitHub</a> if you have any technical <br />
                    issues or ideas to share. I wish you the best and hope you <br />
                    have a fantastic life. <br />
                </p>
            </div>
            <div class="footer-column">
                <h2>Follow me</h2>
                <ul class="social-media">
                    <li>
                        <a class="fa fa-youtube" href="https://www.youtube.com/channel/UCGPoHTVjMN77wcGknXPHl1Q" target="_blank" title="YouTube">
                        </a>YouTube
                    </li>
                    <li>
                        <a class="fa fa-linkedin" href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" target="_blank" title="LinkedIn">
                        </a>LinkedIn
                    </li>
                    <li>
                        <a class="fa fa-instagram" href="https://www.instagram.com/linuxchallenges/" target="_blank" title="Instagram">
                        </a>Instagram
                    </li>
                    <li>
                        <a class="fa fa-github" href="https://github.com/djeada" title="GitHub">
                        </a>Github
                    </li>
                </ul>
            </div>
        </div>
        <div>
            <p id="copyright">
                Â© Adam Djellouli. All rights reserved.
            </p>
        </div>
        <script>
            document.getElementById("copyright").innerHTML = "&copy; " + new Date().getFullYear() + " Adam Djellouli. All rights reserved.";
        </script>
        <script src="../../app.js"></script>
    </footer>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-cpp.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
jax: ["input/TeX", "output/HTML-CSS"],
extensions: ["tex2jax.js"],
"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] },
tex2jax: { inlineMath: [ ["$", "$"] ], displayMath: [ ["$$","$$"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
messageStyle: "none"
});
</script>
<script async="" id="MathJax-script" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

</html>