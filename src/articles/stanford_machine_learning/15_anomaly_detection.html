<!DOCTYPE html>

<html lang="en">

<head>
    <script async="" crossorigin="anonymous" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5593122079896089"></script>
    <meta charset="utf-8" />
    <title>Anomaly Detection in Machine Learning</title>
    <meta content="Anomaly detection involves identifying data points that significantly differ from the majority of the data, often signaling unusual or suspicious activities." name="description" />
    <meta content="Adam Djellouli" name="author" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <link crossorigin="" href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css" rel="stylesheet" />
    <link href="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/icon.ico" rel="icon" />
    <link href="../../resources/style.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
</head>

<body>
    <nav aria-label="Main navigation">
        <a class="logo" href="https://adamdjellouli.com">
            <img alt="Adam Djellouli - Home Page Logo" id="logo-image" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/logo.PNG" />
        </a>
        <input aria-label="Toggle navigation menu" id="navbar-toggle" type="checkbox" />
        <ul aria-labelledby="navbar-toggle" role="menu">
            <li role="menuitem">
                <a href="../../index.html" title="Go to Home Page"> Home </a>
            </li>
            <li role="menuitem">
                <a class="active" href="../../core/blog.html" title="Read Adam Djellouli Blog on Programming and Technology"> Blog </a>
            </li>
            <li role="menuitem">
                <a href="../../core/tools.html" title="Discover Tools Created by Adam Djellouli"> Tools </a>
            </li>
            <li role="menuitem">
                <a href="../../core/projects.html" title="Explore Projects Developed by Adam Djellouli"> Projects </a>
            </li>
            <li role="menuitem">
                <a href="../../core/resume.html" title="View Adam Djellouli Professional Resume"> Resume </a>
            </li>
            <li>
                <button aria-label="Toggle dark mode" id="dark-mode-button"></button>
            </li>
        </ul>
    </nav>
    <div id="article-wrapper">
        <section id="article-body">
            <p style="text-align: right;"><i>Last modified: June 15, 2024</i></p>
            <p style="text-align: right;"><i>This article is written in: ðŸ‡ºðŸ‡¸</i></p>
            <h2 id="anomaly-detection-in-machine-learning">Anomaly Detection in Machine Learning</h2>
            <p>Anomaly detection involves identifying data points that significantly differ from the majority of the data, often signaling unusual or suspicious activities. This technique is widely used across various domains, such as fraud detection, manufacturing, and system monitoring.</p>
            <h3 id="concept-of-anomaly-detection">Concept of Anomaly Detection</h3>
            <ul>
                <li><strong>Baseline Establishment</strong>: The first step in anomaly detection is to establish a normal pattern or baseline from the dataset.</li>
                <li><strong>Probability Threshold (Epsilon)</strong>: Data points are flagged as anomalies if their probability, according to the established model, falls below a threshold $\epsilon$.</li>
                <li>If $p(x_{\text{test}}) &lt; \epsilon$, the data point is considered an anomaly.</li>
                <li>If $p(x_{\text{test}}) \geq \epsilon$, the data point is considered normal.</li>
                <li><strong>Threshold Selection</strong>: The value of $\epsilon$ is critical and is chosen based on the desired confidence level and the specific context of the application.</li>
            </ul>
            <p><img alt="Illustration of Anomaly Detection" src="https://raw.githubusercontent.com/djeada/Stanford-Machine-Learning/main/slides/resources/anomaly.png" /></p>
            <h3 id="applications-of-anomaly-detection">Applications of Anomaly Detection</h3>
            <p>I. Fraud Detection:</p>
            <ul>
                <li>User behavior metrics (online time, login location, spending patterns) are analyzed.</li>
                <li>A model of typical user behavior is created, and deviations are flagged as potential fraud.</li>
            </ul>
            <p>II. Manufacturing: In scenarios like aircraft engine production, anomalies can indicate defects or potential failures.</p>
            <p>III. Data Center Monitoring: Monitoring metrics (memory usage, disk accesses, CPU load) to identify machines that are likely to fail.</p>
            <h3 id="utilizing-the-gaussian-distribution">Utilizing the Gaussian Distribution</h3>
            <ul>
                <li><strong>Mean ($\mu$) and Variance ($\sigma^2$)</strong>: The Gaussian distribution is characterized by these parameters.</li>
                <li><strong>Probability Calculation</strong>:</li>
            </ul>
            <p>$$
                p(x; \mu; \sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
                $$</p>
            <p><img alt="Gaussian Distribution" src="https://raw.githubusercontent.com/djeada/Stanford-Machine-Learning/main/slides/resources/gaussian.png" /></p>
            <ul>
                <li><strong>Data Fitting</strong>: Estimating the Gaussian distribution from the dataset to represent the normal behavior.</li>
            </ul>
            <p><img alt="Data Fitting with Gaussian" src="https://raw.githubusercontent.com/djeada/Stanford-Machine-Learning/main/slides/resources/data_fit.png" /></p>
            <h3 id="evaluating-anomaly-detection-systems">Evaluating Anomaly Detection Systems</h3>
            <ul>
                <li><strong>Data Split</strong>: Divide the data into training, cross-validation, and test sets.</li>
                <li><strong>Performance Metrics</strong>: Precision and recall are often used to evaluate the effectiveness of the anomaly detection system.</li>
                <li><strong>Fine-Tuning</strong>: Adjust the model and $\epsilon$ based on the performance metrics to improve accuracy.</li>
            </ul>
            <h3 id="algorithm-steps">Algorithm Steps</h3>
            <ol>
                <li>
                    <p><strong>Feature Selection</strong>: Choose features $x_i$ that might be indicators of anomalous behavior.</p>
                </li>
                <li>
                    <p><strong>Parameter Fitting</strong>: Calculate the mean ($\mu_j$) and variance ($\sigma_j^2$) for each feature</p>
                </li>
            </ol>
            <p>$$
                \mu_j = \frac{1}{m} \sum_{i=1}^m x_j^{(i)}
                $$</p>
            <p>$$
                \sigma_j^2 = \frac{1}{m} \sum_{i=1}^m (x_j^{(i)} - \mu_j)^2
                $$</p>
            <ol>
                <li><strong>Probability Computation for New Example</strong>: For a new example $x$, compute the probability $p(x)$:</li>
            </ol>
            <p>$$
                p(x) = \prod_{j=1}^n \frac{1}{\sqrt{2\pi\sigma_j^2}} \exp\left(-\frac{(x_j - \mu_j)^2}{2\sigma_j^2}\right)
                $$</p>
            <h3 id="developing-and-evaluating-an-anomaly-detection-system">Developing and Evaluating an Anomaly Detection System</h3>
            <p>I. <strong>Labeled Data</strong>: Have a dataset where $y=0$ indicates normal (non-anomalous) examples, and $y=1$ represents anomalous examples.</p>
            <p>II. <strong>Data Division</strong>: Separate the dataset into a training set (normal examples), a cross-validation (CV) set, and a test set, with both the CV and test sets including some anomalous examples.</p>
            <p>III. <strong>Example Case</strong>:</p>
            <ul>
                <li>Imagine a dataset with 10,000 normal (good) engines and 50 flawed (anomalous) engines.</li>
                <li>Training set: 6,000 good engines.</li>
                <li>CV set: 2,000 good engines, 10 anomalous.</li>
                <li>Test set: 2,000 good engines, 10 anomalous.</li>
            </ul>
            <p>IV. <strong>Evaluation Metrics</strong>:</p>
            <ul>
                <li>True positives (TP), false positives (FP), false negatives (FN), and true negatives (TN).</li>
                <li>Precision (the proportion of true positives among all positives identified by the model).</li>
                <li>Recall (the proportion of true positives identified out of all actual positives).</li>
                <li>F1-score (a harmonic mean of precision and recall, providing a balance between them).</li>
            </ul>
            <h3 id="selecting-a-good-evaluation-metric">Selecting a Good Evaluation Metric</h3>
            <ul>
                <li><strong>F1-Score</strong>: This is particularly useful in the context of anomaly detection where the class distribution is highly imbalanced (many more normal than anomalous examples).</li>
                <li><strong>Precision and Recall</strong>: These metrics provide a more nuanced understanding of the systemâ€™s performance, especially when the cost of false positives and false negatives varies.</li>
            </ul>
            <h3 id="concept-of-multivariate-gaussian-distribution">Concept of Multivariate Gaussian Distribution</h3>
            <ul>
                <li><strong>Scenario</strong>: Imagine fitting a Gaussian distribution to two features, such as CPU load and memory usage.</li>
                <li><strong>Example</strong>: In a test set, consider an example with a high memory use (x1 = 1.5) but low CPU load (x2 = 0.4). Individually, these values might fall within normal ranges, but their combination could be anomalous.</li>
            </ul>
            <p><img alt="Example of Multivariate Gaussian Distribution" src="https://raw.githubusercontent.com/djeada/Stanford-Machine-Learning/main/slides/resources/mult_gauss.png" /></p>
            <h3 id="parameters-of-the-multivariate-gaussian-model">Parameters of the Multivariate Gaussian Model</h3>
            <ul>
                <li><strong>Mean Vector ($\mu$)</strong>: An n-dimensional vector representing the mean of each feature.</li>
                <li><strong>Covariance Matrix ($\Sigma$)</strong>: An $[n \times n]$ matrix, capturing how each pair of features varies together.</li>
                <li><strong>Probability Density Function</strong>:</li>
            </ul>
            <p>$$
                p(x; \mu; \Sigma) = \frac{1}{(2\pi)^{n/2}|\Sigma|^{1/2}} \exp\left(-\frac{1}{2}(x - \mu)^T \Sigma^{-1}(x - \mu)\right)
                $$</p>
            <p><img alt="Covariance Matrix" src="https://raw.githubusercontent.com/djeada/Stanford-Machine-Learning/main/slides/resources/cov_matrix_sigma.png" /></p>
            <h3 id="gaussian-model-vs-multivariate-gaussian-model">Gaussian Model vs. Multivariate Gaussian Model</h3>
            <h4 id="gaussian-model">Gaussian Model</h4>
            <ul>
                <li><strong>Usage</strong>: More commonly used in anomaly detection.</li>
                <li><strong>Feature Creation</strong>: Requires manual creation of features to capture unusual combinations in values.</li>
                <li><strong>Computational Efficiency</strong>: Generally more computationally efficient.</li>
                <li><strong>Scalability</strong>: Scales well to large feature vectors.</li>
                <li><strong>Training Set Size</strong>: Works effectively even with small training sets.</li>
            </ul>
            <h4 id="multivariate-gaussian-model">Multivariate Gaussian Model</h4>
            <ul>
                <li><strong>Usage</strong>: Used less frequently.</li>
                <li><strong>Feature Correlations</strong>: Directly captures correlations between features without needing extra feature engineering.</li>
                <li><strong>Computational Cost</strong>: Less efficient computationally.</li>
                <li><strong>Data Requirements</strong>: Requires more examples than the number of features (m &gt; n).</li>
                <li><strong>Advantage</strong>: Can detect anomalies that occur due to unusual combinations of normal-appearing individual features.</li>
            </ul>
        </section>
        <div id="table-of-contents">
            <h2>Table of Contents</h2>
            <ol><a href="#anomaly-detection-in-machine-learning">Anomaly Detection in Machine Learning</a>
                <ol>
                    <li><a href="#concept-of-anomaly-detection">Concept of Anomaly Detection</a></li>
                    <li><a href="#applications-of-anomaly-detection">Applications of Anomaly Detection</a></li>
                    <li><a href="#utilizing-the-gaussian-distribution">Utilizing the Gaussian Distribution</a></li>
                    <li><a href="#evaluating-anomaly-detection-systems">Evaluating Anomaly Detection Systems</a></li>
                    <li><a href="#algorithm-steps">Algorithm Steps</a></li>
                    <li><a href="#developing-and-evaluating-an-anomaly-detection-system">Developing and Evaluating an Anomaly Detection System</a></li>
                    <li><a href="#selecting-a-good-evaluation-metric">Selecting a Good Evaluation Metric</a></li>
                    <li><a href="#concept-of-multivariate-gaussian-distribution">Concept of Multivariate Gaussian Distribution</a></li>
                    <li><a href="#parameters-of-the-multivariate-gaussian-model">Parameters of the Multivariate Gaussian Model</a></li>
                    <li><a href="#gaussian-model-vs-multivariate-gaussian-model">Gaussian Model vs. Multivariate Gaussian Model</a>
                        <ol>
                            <li><a href="#gaussian-model">Gaussian Model</a></li>
                            <li><a href="#multivariate-gaussian-model">Multivariate Gaussian Model</a></li>
                        </ol>
                    </li>
                </ol>
            </ol>
            <div id="related-articles">
                <h2>Related Articles</h2>
                <ol>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/01_introduction_to_machine_learning.html">Introduction to Machine Learning</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/02_linear_regression.html">Linear Regression</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/03_review_of_linear_algebra.html">Review of Linear Algebra</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/04_linear_regression_multiple_variables.html">Linear Regression Multiple Variables</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/06_logistic_regression.html">Logistic Regression</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/07_regularization.html">Regularization</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/08_neural_networks_representation.html">Neural Networks Representation</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/09_neural_networks_learning.html">Neural Networks Learning</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/10_applying_machine_learning_advice.html">Applying Machine Learning Advice</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/11_machine_learning_system_design.html">Machine Learning System Design</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/12_support_vector_machines.html">Support Vector Machines</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/13_clustering.html">Clustering</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/14_dimensionality_reduction.html">Dimensionality Reduction</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/15_anomaly_detection.html">Anomaly Detection</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/16_recommendation_systems.html">Recommendation Systems</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/17_large_scale_machine_learning.html">Large Scale Machine Learning</a></li>
                    <li><a href="https://adamdjellouli.com/articles/stanford_machine_learning/18_photo_ocr.html">Photo Ocr</a></li>
                </ol>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer-columns">
            <div class="footer-column">
                <img alt="Adam Djellouli Symbol" src="https://raw.githubusercontent.com/djeada/Personal-Website/master/images/symbol.png" />
            </div>
            <div class="footer-column">
                <h2><a href="https://adamdjellouli.com/core/privacy_policy.html" title="Privacy Policy">Our Privacy Policy</a></h2>
                <p>
                    Thank you for visiting my personal website. All of the <br />
                    content on this site is free to use, but please remember <br />
                    to be a good human being and refrain from any abuse<br />
                    of the site. If you would like to contact me, please use <br />
                    my <a href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" title="LinkedIn Profile">LinkedIn profile</a> or my <a href="https://github.com/djeada" title="GitHub Profile">GitHub</a> if you have any technical <br />
                    issues or ideas to share. I wish you the best and hope you <br />
                    have a fantastic life. <br />
                </p>
            </div>
            <div class="footer-column">
                <h2>Follow me</h2>
                <ul class="social-media">
                    <li>
                        <a class="fa fa-youtube" href="https://www.youtube.com/channel/UCGPoHTVjMN77wcGknXPHl1Q" target="_blank" title="YouTube">
                        </a>YouTube
                    </li>
                    <li>
                        <a class="fa fa-linkedin" href="https://www.linkedin.com/in/adam-djellouli-1bb54619a/" target="_blank" title="LinkedIn">
                        </a>LinkedIn
                    </li>
                    <li>
                        <a class="fa fa-instagram" href="https://www.instagram.com/linuxchallenges/" target="_blank" title="Instagram">
                        </a>Instagram
                    </li>
                    <li>
                        <a class="fa fa-github" href="https://github.com/djeada" title="GitHub">
                        </a>Github
                    </li>
                </ul>
            </div>
        </div>
        <div>
            <p id="copyright">
                Â© Adam Djellouli. All rights reserved.
            </p>
        </div>
        <script>
            document.getElementById("copyright").innerHTML = "&copy; " + new Date().getFullYear() + " Adam Djellouli. All rights reserved.";
        </script>
        <script src="../../app.js"></script>
    </footer>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-cpp.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
jax: ["input/TeX", "output/HTML-CSS"],
extensions: ["tex2jax.js"],
"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] },
tex2jax: { inlineMath: [ ["$", "$"] ], displayMath: [ ["$$","$$"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
messageStyle: "none"
});
</script>
<script async="" id="MathJax-script" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

</html>